(function(_0x3b97f0,_0x3e3cc5){const _0x33de0b=a4_0x2d7f,_0x42d2fa=_0x3b97f0();while(!![]){try{const _0x5e5777=-parseInt(_0x33de0b(0x1ab))/0x1*(parseInt(_0x33de0b(0x1a5))/0x2)+-parseInt(_0x33de0b(0x1a0))/0x3+-parseInt(_0x33de0b(0x1a9))/0x4+-parseInt(_0x33de0b(0x1aa))/0x5*(parseInt(_0x33de0b(0x1a2))/0x6)+parseInt(_0x33de0b(0x1a8))/0x7*(parseInt(_0x33de0b(0x1a7))/0x8)+-parseInt(_0x33de0b(0x1a1))/0x9+parseInt(_0x33de0b(0x1ac))/0xa;if(_0x5e5777===_0x3e3cc5)break;else _0x42d2fa['push'](_0x42d2fa['shift']());}catch(_0x1e86de){_0x42d2fa['push'](_0x42d2fa['shift']());}}}(a4_0x508c,0x6c874));const connections=new Map();export function getConnectionsDebugInfo(){const _0x57a09a=a4_0x2d7f;return{'totalConnections':connections['size'],'sessionIds':Array['from'](connections['keys']()),'timestamp':new Date()[_0x57a09a(0x1ad)]()};}function a4_0x2d7f(_0x170c94,_0x3c4055){const _0x508c0e=a4_0x508c();return a4_0x2d7f=function(_0x2d7f6a,_0x9f8811){_0x2d7f6a=_0x2d7f6a-0x1a0;let _0x179839=_0x508c0e[_0x2d7f6a];return _0x179839;},a4_0x2d7f(_0x170c94,_0x3c4055);}function a4_0x508c(){const _0x43a7a1=['970040WBvDiR','14FXdLtO','1833544XTBTJq','55WpFXNS','1oFNpDD','15429060yBdAhq','toISOString','408357mIvClO','1908225FARFaz','215220CApCCX','log','stringify','279568bMJoXA','üßπ\x20Connection\x20safely\x20closed\x20for\x20sessionId:'];a4_0x508c=function(){return _0x43a7a1;};return a4_0x508c();}export function addConnection(_0x706e3f,_0x44ad80){connections['set'](_0x706e3f,{'controller':_0x44ad80,'isClosed':![]}),console['log']('üîó\x20New\x20SSE\x20connection\x20added:',{'sessionId':_0x706e3f,'totalConnections':connections['size'],'allSessionIds':Array['from'](connections['keys']())});}export function removeConnection(_0xe56fe3,_0x298053=!![]){const _0x100b94=a4_0x2d7f,_0x104b31=connections['get'](_0xe56fe3);if(_0x104b31&&!_0x104b31['isClosed'])try{_0x104b31['controller']['close'](),_0x104b31['isClosed']=!![],!_0x298053&&console['log'](_0x100b94(0x1a6),_0xe56fe3);}catch(_0x5b808b){const _0x2f6d63=_0x298053?'Error\x20closing\x20SSE\x20controller\x20during\x20removal:':'Error\x20closing\x20SSE\x20controller:';console['error'](_0x2f6d63,_0x5b808b);}const _0x3d7169=connections['delete'](_0xe56fe3);_0x298053&&console['log']('üîå\x20SSE\x20connection\x20removed:',{'sessionId':_0xe56fe3,'existed':_0x3d7169,'remainingConnections':connections['size']});}export function sendPaymentUpdate(_0x5c30c5,_0x4c2147){const _0x46fe41=a4_0x2d7f;console['log']('üîÑ\x20Attempting\x20to\x20send\x20payment\x20update:',{'sessionId':_0x5c30c5,'data':_0x4c2147,'totalConnections':connections['size'],'hasConnection':connections['has'](_0x5c30c5)});const _0x517764=connections['get'](_0x5c30c5);if(_0x517764&&!_0x517764['isClosed'])try{const _0x377343='data:\x20'+JSON['stringify'](_0x4c2147)+'\x0a\x0a';_0x517764['controller']['enqueue'](_0x377343),console[_0x46fe41(0x1a3)]('‚úÖ\x20SSE\x20message\x20sent\x20successfully:',_0x377343['trim']()),(_0x4c2147['type']==='payment_approved'||_0x4c2147['type']==='payment_failed')&&setTimeout(()=>{removeConnection(_0x5c30c5,![]);},0x3e8);}catch(_0x21a055){console['error']('‚ùå\x20Error\x20sending\x20SSE\x20message:',_0x21a055),removeConnection(_0x5c30c5,![]);}else console['warn']('‚ö†Ô∏è\x20No\x20active\x20SSE\x20connection\x20found\x20for\x20sessionId:',_0x5c30c5),console['log']('üìã\x20Available\x20connections:',Array['from'](connections['keys']())),setTimeout(()=>{const _0x42e7b9=_0x46fe41,_0x24a921=connections['get'](_0x5c30c5);if(_0x24a921&&!_0x24a921['isClosed'])try{const _0x3089e1='data:\x20'+JSON[_0x42e7b9(0x1a4)](_0x4c2147)+'\x0a\x0a';_0x24a921['controller']['enqueue'](_0x3089e1),console['log']('‚úÖ\x20SSE\x20message\x20sent\x20successfully\x20on\x20retry:',_0x3089e1['trim']()),(_0x4c2147['type']==='payment_approved'||_0x4c2147['type']==='payment_failed')&&setTimeout(()=>{removeConnection(_0x5c30c5,![]);},0x3e8);}catch(_0xc8eb11){console['error']('‚ùå\x20Error\x20sending\x20SSE\x20message\x20on\x20retry:',_0xc8eb11),removeConnection(_0x5c30c5,![]);}else console['warn']('‚ö†Ô∏è\x20SSE\x20connection\x20still\x20not\x20found\x20after\x20retry\x20for\x20sessionId:',_0x5c30c5);},0x7d0);}