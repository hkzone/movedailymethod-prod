(function(_0x181940,_0x5a024c){const _0x45918c=a11_0x15e7,_0x8d01fd=_0x181940();while(!![]){try{const _0x495c84=-parseInt(_0x45918c(0xf2))/0x1+-parseInt(_0x45918c(0xf6))/0x2*(-parseInt(_0x45918c(0xf8))/0x3)+-parseInt(_0x45918c(0xef))/0x4*(-parseInt(_0x45918c(0xeb))/0x5)+parseInt(_0x45918c(0xea))/0x6*(-parseInt(_0x45918c(0xf1))/0x7)+parseInt(_0x45918c(0xee))/0x8*(parseInt(_0x45918c(0xf7))/0x9)+-parseInt(_0x45918c(0xf3))/0xa+parseInt(_0x45918c(0xed))/0xb;if(_0x495c84===_0x5a024c)break;else _0x8d01fd['push'](_0x8d01fd['shift']());}catch(_0x52f0ca){_0x8d01fd['push'](_0x8d01fd['shift']());}}}(a11_0x3b1c,0xa6895));import a11_0x2e60e0 from'groq';function a11_0x3b1c(){const _0x314955=['1401316YMgeqZ','create','2245964Cutugb','640490FmCNUc','5746030pMyIai','data','_id','3832NudgKb','117mhIUkT','3tHxyuj','24cTDkwU','5TtQous','module','17209533VBFSav','777776vTFXTD'];a11_0x3b1c=function(){return _0x314955;};return a11_0x3b1c();}import{client}from'../adminClient';import{getStudentByClerkId}from'../student/getStudentByClerkId';import{sanityFetch}from'../live';function a11_0x15e7(_0x544176,_0xa1572e){const _0x3b1c4c=a11_0x3b1c();return a11_0x15e7=function(_0x15e77d,_0x2df03c){_0x15e77d=_0x15e77d-0xea;let _0x40d87a=_0x3b1c4c[_0x15e77d];return _0x40d87a;},a11_0x15e7(_0x544176,_0xa1572e);}export async function completeLessonById({lessonId:_0x4411cf,clerkId:_0x5e8f96}){const _0x3a5a63=a11_0x15e7;try{const _0x1eeb92=await getStudentByClerkId(_0x5e8f96);if(!_0x1eeb92?.[_0x3a5a63(0xf4)]?.['_id'])throw new Error('Student\x20not\x20found');const _0x3c081d=_0x1eeb92['data']['_id'],_0x56460f=await sanityFetch({'query':a11_0x2e60e0`*[_type == "lessonCompletion" && student._ref == $studentId && lesson._ref == $lessonId][0]`,'params':{'studentId':_0x3c081d,'lessonId':_0x4411cf}});if(_0x56460f['data'])return _0x56460f['data'];const _0x58c2b5=await sanityFetch({'query':a11_0x2e60e0`*[_type == "lesson" && _id == $lessonId][0]{
        _id,
        "module": *[_type == "module" && references(^._id)][0]{
          _id,
          "course": *[_type == "course" && references(^._id)][0]._id
        }
      }`,'params':{'lessonId':_0x4411cf}});if(!_0x58c2b5?.['data']?.['module']?.['_id']||!_0x58c2b5?.['data']?.['module']?.['course'])throw new Error('Could\x20not\x20find\x20module\x20or\x20course\x20for\x20lesson');const _0x2ac296=await client[_0x3a5a63(0xf0)]({'_type':'lessonCompletion','student':{'_type':'reference','_ref':_0x3c081d},'lesson':{'_type':'reference','_ref':_0x4411cf},'module':{'_type':'reference','_ref':_0x58c2b5['data'][_0x3a5a63(0xec)][_0x3a5a63(0xf5)]},'course':{'_type':'reference','_ref':_0x58c2b5['data']['module']['course']},'completedAt':new Date()['toISOString']()});return _0x2ac296;}catch(_0x37703c){console['error']('Error\x20completing\x20lesson:',_0x37703c);throw _0x37703c;}}