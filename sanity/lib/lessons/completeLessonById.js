(function(_0x552f42,_0xdc900d){const _0x2cfd59=a11_0x19bc,_0x488f90=_0x552f42();while(!![]){try{const _0x3b3b54=-parseInt(_0x2cfd59(0x1f2))/0x1*(-parseInt(_0x2cfd59(0x1fb))/0x2)+parseInt(_0x2cfd59(0x1f6))/0x3*(-parseInt(_0x2cfd59(0x1f5))/0x4)+-parseInt(_0x2cfd59(0x1f1))/0x5+parseInt(_0x2cfd59(0x1f8))/0x6+parseInt(_0x2cfd59(0x1f7))/0x7+parseInt(_0x2cfd59(0x1f3))/0x8*(parseInt(_0x2cfd59(0x1f9))/0x9)+-parseInt(_0x2cfd59(0x1f4))/0xa;if(_0x3b3b54===_0xdc900d)break;else _0x488f90['push'](_0x488f90['shift']());}catch(_0x30e98b){_0x488f90['push'](_0x488f90['shift']());}}}(a11_0x2eda,0x4700e));import a11_0x47b92b from'groq';import{client}from'../adminClient';function a11_0x19bc(_0x26d2fd,_0x5bbe6e){const _0x2eda4f=a11_0x2eda();return a11_0x19bc=function(_0x19bc0b,_0x36a558){_0x19bc0b=_0x19bc0b-0x1f1;let _0xf33180=_0x2eda4f[_0x19bc0b];return _0xf33180;},a11_0x19bc(_0x26d2fd,_0x5bbe6e);}import{getStudentByClerkId}from'../student/getStudentByClerkId';function a11_0x2eda(){const _0x156261=['852LHUdCP','4281vxOvFh','4045650lthMBX','2238090ikjZVt','2014569fhrmhf','data','75094DLIazi','2420875NdVaWk','13YDVMFp','16wahHIE','8078020qfSxZw'];a11_0x2eda=function(){return _0x156261;};return a11_0x2eda();}import{sanityFetch}from'../live';export async function completeLessonById({lessonId:_0xf679c8,clerkId:_0x4c75c0}){const _0x53730d=a11_0x19bc;try{const _0x41e2c8=await getStudentByClerkId(_0x4c75c0);if(!_0x41e2c8?.['data']?.['_id'])throw new Error('Student\x20not\x20found');const _0x6140b6=_0x41e2c8['data']['_id'],_0x5cd12e=await sanityFetch({'query':a11_0x47b92b`*[_type == "lessonCompletion" && student._ref == $studentId && lesson._ref == $lessonId][0]`,'params':{'studentId':_0x6140b6,'lessonId':_0xf679c8}});if(_0x5cd12e['data'])return _0x5cd12e['data'];const _0x3d805f=await sanityFetch({'query':a11_0x47b92b`*[_type == "lesson" && _id == $lessonId][0]{
        _id,
        "module": *[_type == "module" && references(^._id)][0]{
          _id,
          "course": *[_type == "course" && references(^._id)][0]._id
        }
      }`,'params':{'lessonId':_0xf679c8}});if(!_0x3d805f?.['data']?.['module']?.['_id']||!_0x3d805f?.[_0x53730d(0x1fa)]?.['module']?.['course'])throw new Error('Could\x20not\x20find\x20module\x20or\x20course\x20for\x20lesson');const _0x2ca82a=await client['create']({'_type':'lessonCompletion','student':{'_type':'reference','_ref':_0x6140b6},'lesson':{'_type':'reference','_ref':_0xf679c8},'module':{'_type':'reference','_ref':_0x3d805f['data']['module']['_id']},'course':{'_type':'reference','_ref':_0x3d805f['data']['module']['course']},'completedAt':new Date()['toISOString']()});return _0x2ca82a;}catch(_0x4884ee){console['error']('Error\x20completing\x20lesson:',_0x4884ee);throw _0x4884ee;}}