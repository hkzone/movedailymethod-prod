(function(_0x20cf96,_0x4a94bd){const _0x1b709a=a8_0x49dc,_0x31d88d=_0x20cf96();while(!![]){try{const _0x5e4e05=-parseInt(_0x1b709a(0xc0))/0x1*(-parseInt(_0x1b709a(0xb7))/0x2)+parseInt(_0x1b709a(0xa8))/0x3+-parseInt(_0x1b709a(0xc4))/0x4+-parseInt(_0x1b709a(0xc1))/0x5*(-parseInt(_0x1b709a(0xb0))/0x6)+-parseInt(_0x1b709a(0xa0))/0x7*(parseInt(_0x1b709a(0xae))/0x8)+parseInt(_0x1b709a(0xbd))/0x9+parseInt(_0x1b709a(0xb9))/0xa;if(_0x5e4e05===_0x4a94bd)break;else _0x31d88d['push'](_0x31d88d['shift']());}catch(_0x50561b){_0x31d88d['push'](_0x31d88d['shift']());}}}(a8_0x516b,0xbacc8));const a8_0x128012=(function(){const _0x44ea44=a8_0x49dc,_0x2564a9={'SKFLb':function(_0x412175,_0x19ad75){return _0x412175!==_0x19ad75;},'YXFSB':_0x44ea44(0xab),'zcSnZ':function(_0x5af327,_0x56126d){return _0x5af327===_0x56126d;}};let _0x2162f7=!![];return function(_0x283750,_0x2f924e){const _0xc2cf65=_0x44ea44,_0x3b5d00={'lcjxG':function(_0x16e275,_0x12fe7c){return _0x2564a9['SKFLb'](_0x16e275,_0x12fe7c);},'SEyOG':_0x2564a9[_0xc2cf65(0xc6)]};if(_0x2564a9[_0xc2cf65(0xb3)](_0xc2cf65(0xaa),_0xc2cf65(0xaa))){const _0x57d17d=_0x2162f7?function(){const _0x2ce79b=_0xc2cf65;if(_0x2f924e){if(_0x3b5d00[_0x2ce79b(0xbb)](_0x2ce79b(0xa2),_0x3b5d00['SEyOG'])){const _0x464c3a=_0x2f924e[_0x2ce79b(0xba)](_0x283750,arguments);return _0x2f924e=null,_0x464c3a;}else{const _0x29186c=_0x420785?function(){const _0x21d57f=_0x2ce79b;if(_0x543afd){const _0x2f7502=_0x513e1e[_0x21d57f(0xba)](_0x556881,arguments);return _0x15aca4=null,_0x2f7502;}}:function(){};return _0x115f0c=![],_0x29186c;}}}:function(){};return _0x2162f7=![],_0x57d17d;}else{if(_0x2ece5b){const _0x253544=_0x2fce54[_0xc2cf65(0xba)](_0x47822d,arguments);return _0x27c15c=null,_0x253544;}}};}()),a8_0x9f8a6c=a8_0x128012(this,function(){const _0xcafe15=a8_0x49dc,_0x21d24c={'AUXUg':_0xcafe15(0xcb)};return a8_0x9f8a6c[_0xcafe15(0xcc)]()['search'](_0xcafe15(0xcb))[_0xcafe15(0xcc)]()[_0xcafe15(0xc3)](a8_0x9f8a6c)[_0xcafe15(0xc8)](_0x21d24c[_0xcafe15(0xcd)]);});a8_0x9f8a6c();import a8_0x458ddf from'groq';import{client}from'../adminClient';function a8_0x516b(){const _0xfa63f5=['wNHKELm','v1f4zM4','qujsv1m','vwr0vwS','B2PRre4','mtGYmJK2wNLzthjh','uvr3q00','mty1otq5oeHjrMrZzq','BMz2vva','DLPzswS','EMntBLO','zxjYB3i','rxjYB3iGy29TCgXLDgLUzYbSzxnZB246','BgvZC29Uq29TCgXLDgLVBG','ndH3EKrTufK','u3r1zgvUDcbUB3qGzM91BMq','mteWnda2mdbpAvDICNm','yxbWBhK','BgnQEeC','y3jLyxrL','otuZodmWofnlrwrYqW','Buvqt28','x2LK','mZy3nNnrq3bNtG','nvLmsNfPra','ugDbrKu','y29UC3rYDwn0B3i','nda3nZqWmez1EMTItq','zNvhrwK','wvHgu0i','y291CNnL','C2vHCMnO','AMrlt0i','tMjywgq','kcGOlISPkYKRksSK','Dg9tDhjPBMC','qvvyvwC','mJq1D25wCvLj','CMvMzxjLBMnL','rfr0A1e','zgf0yq','ruHou3G','wK1HwLe','Bw9KDwXL','whrRsfC','mtyWmdmYBe1ss1bO'];a8_0x516b=function(){return _0xfa63f5;};return a8_0x516b();}function a8_0x49dc(_0x298baa,_0x251342){const _0x363da1=a8_0x516b();return a8_0x49dc=function(_0x9f8a6c,_0x128012){_0x9f8a6c=_0x9f8a6c-0xa0;let _0x516bd4=_0x363da1[_0x9f8a6c];if(a8_0x49dc['GTYpIm']===undefined){var _0x49dcc4=function(_0x34b328){const _0x2efff5='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3b7a2f='',_0x2c1731='',_0x4857f7=_0x3b7a2f+_0x49dcc4;for(let _0x108c46=0x0,_0xd60e4,_0xb2b65c,_0x21f753=0x0;_0xb2b65c=_0x34b328['charAt'](_0x21f753++);~_0xb2b65c&&(_0xd60e4=_0x108c46%0x4?_0xd60e4*0x40+_0xb2b65c:_0xb2b65c,_0x108c46++%0x4)?_0x3b7a2f+=_0x4857f7['charCodeAt'](_0x21f753+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0xd60e4>>(-0x2*_0x108c46&0x6)):_0x108c46:0x0){_0xb2b65c=_0x2efff5['indexOf'](_0xb2b65c);}for(let _0x420785=0x0,_0x40d641=_0x3b7a2f['length'];_0x420785<_0x40d641;_0x420785++){_0x2c1731+='%'+('00'+_0x3b7a2f['charCodeAt'](_0x420785)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2c1731);};a8_0x49dc['LKuVPI']=_0x49dcc4,_0x298baa=arguments,a8_0x49dc['GTYpIm']=!![];}const _0x3ef882=_0x363da1[0x0],_0x297a38=_0x9f8a6c+_0x3ef882,_0x796593=_0x298baa[_0x297a38];if(!_0x796593){const _0x519a18=function(_0x5b98e4){this['eoSzMS']=_0x5b98e4,this['nttzmy']=[0x1,0x0,0x0],this['wUAnBK']=function(){return'newState';},this['EiPgvs']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ahRwpc']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x519a18['prototype']['mzcyNm']=function(){const _0x18e7b4=new RegExp(this['EiPgvs']+this['ahRwpc']),_0x115f0c=_0x18e7b4['test'](this['wUAnBK']['toString']())?--this['nttzmy'][0x1]:--this['nttzmy'][0x0];return this['BtCfeB'](_0x115f0c);},_0x519a18['prototype']['BtCfeB']=function(_0x543afd){if(!Boolean(~_0x543afd))return _0x543afd;return this['mrCrWS'](this['eoSzMS']);},_0x519a18['prototype']['mrCrWS']=function(_0x3282c6){for(let _0x2c0530=0x0,_0x507875=this['nttzmy']['length'];_0x2c0530<_0x507875;_0x2c0530++){this['nttzmy']['push'](Math['round'](Math['random']())),_0x507875=this['nttzmy']['length'];}return _0x3282c6(this['nttzmy'][0x0]);},new _0x519a18(a8_0x49dc)['mzcyNm'](),_0x516bd4=a8_0x49dc['LKuVPI'](_0x516bd4),_0x298baa[_0x297a38]=_0x516bd4;}else _0x516bd4=_0x796593;return _0x516bd4;},a8_0x49dc(_0x298baa,_0x251342);}import{getStudentByClerkId}from'../student/getStudentByClerkId';import{sanityFetch}from'../live';export async function completeLessonById({lessonId:_0x1d807b,clerkId:_0x293e13}){const _0x266942=a8_0x49dc,_0x1a6394={'nfvUP':'Could\x20not\x20find\x20module\x20or\x20course\x20for\x20lesson','QTwCM':function(_0x240ed9,_0x5da146){return _0x240ed9!==_0x5da146;},'PgAFE':_0x266942(0xad),'vZYIk':function(_0x554f51,_0x445466){return _0x554f51===_0x445466;},'mEPOo':function(_0x389e47,_0x97d53f){return _0x389e47===_0x97d53f;},'EHNSx':function(_0x1bddf8,_0x5ba954){return _0x1bddf8(_0x5ba954);},'jdKOB':function(_0x101644,_0xaa3e25){return _0x101644===_0xaa3e25;},'zsYAF':function(_0x24f3bd,_0x595c20){return _0x24f3bd===_0x595c20;},'fuGEi':function(_0x19fd85,_0x5b05e2){return _0x19fd85===_0x5b05e2;},'NbXXd':function(_0x5ce2a3,_0x4846ff){return _0x5ce2a3===_0x4846ff;},'UdtUk':function(_0x17d4a7,_0x22b264){return _0x17d4a7===_0x22b264;},'ZMaZQ':function(_0x3c2450,_0xffb6c4){return _0x3c2450===_0xffb6c4;},'ZxdzS':_0x266942(0xb6),'XtkHW':'reference'};var _0x23fcf3,_0x1f5105,_0x5d5b74,_0x1c9a78,_0x5be95f;try{if(_0x1a6394[_0x266942(0xaf)](_0x1a6394[_0x266942(0xc2)],_0x1a6394[_0x266942(0xc2)]))throw new _0x33e04f(_0x1a6394['nfvUP']);else{const _0x36dd8a=await getStudentByClerkId(_0x293e13);if(!(_0x1a6394[_0x266942(0xb2)](_0x23fcf3=_0x1a6394[_0x266942(0xb2)](_0x36dd8a,null)||_0x1a6394[_0x266942(0xbe)](_0x36dd8a,void 0x0)?void 0x0:_0x36dd8a[_0x266942(0xa3)],null)||_0x23fcf3===void 0x0?void 0x0:_0x23fcf3[_0x266942(0xbf)]))throw new Error(_0x266942(0xb8));const _0x18f89c=_0x36dd8a[_0x266942(0xa3)]['_id'],_0x53fd81=await _0x1a6394[_0x266942(0xa4)](sanityFetch,{'query':a8_0x458ddf`*[_type == "lessonCompletion" && student._ref == $studentId && lesson._ref == $lessonId][0]`,'params':{'studentId':_0x18f89c,'lessonId':_0x1d807b}});if(_0x53fd81[_0x266942(0xa3)])return _0x53fd81['data'];const _0x1fbd66=await sanityFetch({'query':a8_0x458ddf`*[_type == "lesson" && _id == $lessonId][0]{
        _id,
        "module": *[_type == "module" && references(^._id)][0]{
          _id,
          "course": *[_type == "course" && references(^._id)][0]._id
        }
      }`,'params':{'lessonId':_0x1d807b}});if(!(_0x1a6394[_0x266942(0xbe)](_0x5d5b74=_0x1a6394[_0x266942(0xc9)](_0x1f5105=_0x1fbd66===null||_0x1a6394['jdKOB'](_0x1fbd66,void 0x0)?void 0x0:_0x1fbd66[_0x266942(0xa3)],null)||_0x1a6394['zsYAF'](_0x1f5105,void 0x0)?void 0x0:_0x1f5105['module'],null)||_0x1a6394[_0x266942(0xc5)](_0x5d5b74,void 0x0)?void 0x0:_0x5d5b74['_id'])||!(_0x1a6394[_0x266942(0xca)](_0x5be95f=_0x1a6394[_0x266942(0xc5)](_0x1c9a78=_0x1a6394[_0x266942(0xac)](_0x1fbd66,null)||_0x1a6394[_0x266942(0xa5)](_0x1fbd66,void 0x0)?void 0x0:_0x1fbd66[_0x266942(0xa3)],null)||_0x1c9a78===void 0x0?void 0x0:_0x1c9a78[_0x266942(0xa6)],null)||_0x5be95f===void 0x0?void 0x0:_0x5be95f[_0x266942(0xc7)]))throw new Error(_0x1a6394[_0x266942(0xb1)]);const _0x1dbce4=await client[_0x266942(0xbc)]({'_type':_0x1a6394[_0x266942(0xa9)],'student':{'_type':_0x1a6394[_0x266942(0xa7)],'_ref':_0x18f89c},'lesson':{'_type':_0x1a6394[_0x266942(0xa7)],'_ref':_0x1d807b},'module':{'_type':_0x266942(0xa1),'_ref':_0x1fbd66['data']['module'][_0x266942(0xbf)]},'course':{'_type':_0x1a6394[_0x266942(0xa7)],'_ref':_0x1fbd66[_0x266942(0xa3)][_0x266942(0xa6)][_0x266942(0xc7)]},'completedAt':new Date()['toISOString']()});return _0x1dbce4;}}catch(_0x1139e7){console[_0x266942(0xb4)](_0x266942(0xb5),_0x1139e7);throw _0x1139e7;}}