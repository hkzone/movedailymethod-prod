function a11_0x1976(_0x33ec59,_0x52a06a){const _0x2af200=a11_0x2af2();return a11_0x1976=function(_0x1976a8,_0x52cae6){_0x1976a8=_0x1976a8-0x1eb;let _0x11d1ed=_0x2af200[_0x1976a8];return _0x11d1ed;},a11_0x1976(_0x33ec59,_0x52a06a);}(function(_0x3189ae,_0x588433){const _0x25b78a=a11_0x1976,_0x52a289=_0x3189ae();while(!![]){try{const _0x514e7e=parseInt(_0x25b78a(0x1f2))/0x1+-parseInt(_0x25b78a(0x1ec))/0x2*(-parseInt(_0x25b78a(0x1f4))/0x3)+-parseInt(_0x25b78a(0x1ed))/0x4+parseInt(_0x25b78a(0x1f3))/0x5+-parseInt(_0x25b78a(0x1f0))/0x6+parseInt(_0x25b78a(0x1ef))/0x7+-parseInt(_0x25b78a(0x1f1))/0x8;if(_0x514e7e===_0x588433)break;else _0x52a289['push'](_0x52a289['shift']());}catch(_0x1424d5){_0x52a289['push'](_0x52a289['shift']());}}}(a11_0x2af2,0x24f86));import a11_0x414f12 from'groq';import{client}from'../adminClient';function a11_0x2af2(){const _0x53b8d8=['create','2114217pNxafU','1343376XRpJBp','2480800riZUuN','182835hjgQdj','600740vPjOIR','3nKcIrv','data','387026ODrREL','452404CGWzJx'];a11_0x2af2=function(){return _0x53b8d8;};return a11_0x2af2();}import{getStudentByClerkId}from'../student/getStudentByClerkId';import{sanityFetch}from'../live';export async function completeLessonById({lessonId:_0x37c62d,clerkId:_0x31fc9b}){const _0x522e83=a11_0x1976;try{const _0x22f1a8=await getStudentByClerkId(_0x31fc9b);if(!_0x22f1a8?.['data']?.['_id'])throw new Error('Student\x20not\x20found');const _0x34819e=_0x22f1a8['data']['_id'],_0x1e9a18=await sanityFetch({'query':a11_0x414f12`*[_type == "lessonCompletion" && student._ref == $studentId && lesson._ref == $lessonId][0]`,'params':{'studentId':_0x34819e,'lessonId':_0x37c62d}});if(_0x1e9a18[_0x522e83(0x1eb)])return _0x1e9a18['data'];const _0x56b7a6=await sanityFetch({'query':a11_0x414f12`*[_type == "lesson" && _id == $lessonId][0]{
        _id,
        "module": *[_type == "module" && references(^._id)][0]{
          _id,
          "course": *[_type == "course" && references(^._id)][0]._id
        }
      }`,'params':{'lessonId':_0x37c62d}});if(!_0x56b7a6?.['data']?.['module']?.['_id']||!_0x56b7a6?.['data']?.['module']?.['course'])throw new Error('Could\x20not\x20find\x20module\x20or\x20course\x20for\x20lesson');const _0xf6a0e5=await client[_0x522e83(0x1ee)]({'_type':'lessonCompletion','student':{'_type':'reference','_ref':_0x34819e},'lesson':{'_type':'reference','_ref':_0x37c62d},'module':{'_type':'reference','_ref':_0x56b7a6['data']['module']['_id']},'course':{'_type':'reference','_ref':_0x56b7a6['data']['module']['course']},'completedAt':new Date()['toISOString']()});return _0xf6a0e5;}catch(_0x123966){console['error']('Error\x20completing\x20lesson:',_0x123966);throw _0x123966;}}