function a8_0xaec2(_0x256feb,_0x57360e){const _0x4854db=a8_0x4854();return a8_0xaec2=function(_0xaec273,_0x1a7fd1){_0xaec273=_0xaec273-0x179;let _0x3fb0ee=_0x4854db[_0xaec273];return _0x3fb0ee;},a8_0xaec2(_0x256feb,_0x57360e);}(function(_0x335e67,_0x6fab18){const _0x2f245a=a8_0xaec2,_0x260188=_0x335e67();while(!![]){try{const _0x16e8c3=-parseInt(_0x2f245a(0x180))/0x1*(parseInt(_0x2f245a(0x183))/0x2)+parseInt(_0x2f245a(0x181))/0x3*(parseInt(_0x2f245a(0x17e))/0x4)+parseInt(_0x2f245a(0x17a))/0x5*(-parseInt(_0x2f245a(0x17d))/0x6)+-parseInt(_0x2f245a(0x17f))/0x7+parseInt(_0x2f245a(0x184))/0x8+parseInt(_0x2f245a(0x179))/0x9+parseInt(_0x2f245a(0x182))/0xa;if(_0x16e8c3===_0x6fab18)break;else _0x260188['push'](_0x260188['shift']());}catch(_0x16e4cf){_0x260188['push'](_0x260188['shift']());}}}(a8_0x4854,0xa85a3));import a8_0x17b690 from'groq';import{client}from'../adminClient';function a8_0x4854(){const _0x46f4e3=['380gmtIFr','9869616qvCZVk','3118005OlIMzR','15bmBwCw','reference','module','1459734ppvHbI','2980lltPsH','4937695wFkDnb','5209CYXLrO','4983ICVDAj','2969410bPGNaF'];a8_0x4854=function(){return _0x46f4e3;};return a8_0x4854();}import{getStudentByClerkId}from'../student/getStudentByClerkId';import{sanityFetch}from'../live';export async function completeLessonById({lessonId:_0x30977a,clerkId:_0x3c5e9d}){const _0x55e3f4=a8_0xaec2;try{const _0x37a415=await getStudentByClerkId(_0x3c5e9d);if(!_0x37a415?.['data']?.['_id'])throw new Error('Student\x20not\x20found');const _0x1e9d30=_0x37a415['data']['_id'],_0x5893f4=await sanityFetch({'query':a8_0x17b690`*[_type == "lessonCompletion" && student._ref == $studentId && lesson._ref == $lessonId][0]`,'params':{'studentId':_0x1e9d30,'lessonId':_0x30977a}});if(_0x5893f4['data'])return _0x5893f4['data'];const _0x210366=await sanityFetch({'query':a8_0x17b690`*[_type == "lesson" && _id == $lessonId][0]{
        _id,
        "module": *[_type == "module" && references(^._id)][0]{
          _id,
          "course": *[_type == "course" && references(^._id)][0]._id
        }
      }`,'params':{'lessonId':_0x30977a}});if(!_0x210366?.['data']?.['module']?.['_id']||!_0x210366?.['data']?.[_0x55e3f4(0x17c)]?.['course'])throw new Error('Could\x20not\x20find\x20module\x20or\x20course\x20for\x20lesson');const _0x4076f9=await client['create']({'_type':'lessonCompletion','student':{'_type':_0x55e3f4(0x17b),'_ref':_0x1e9d30},'lesson':{'_type':_0x55e3f4(0x17b),'_ref':_0x30977a},'module':{'_type':_0x55e3f4(0x17b),'_ref':_0x210366['data']['module']['_id']},'course':{'_type':'reference','_ref':_0x210366['data']['module']['course']},'completedAt':new Date()['toISOString']()});return _0x4076f9;}catch(_0x519593){console['error']('Error\x20completing\x20lesson:',_0x519593);throw _0x519593;}}