(function(_0x458932,_0x133e1e){const _0x54d4f2=a27_0xc5da,_0x9f88c0=_0x458932();while(!![]){try{const _0x24bc14=-parseInt(_0x54d4f2(0x147))/0x1*(parseInt(_0x54d4f2(0x16b))/0x2)+parseInt(_0x54d4f2(0x161))/0x3*(-parseInt(_0x54d4f2(0x14b))/0x4)+parseInt(_0x54d4f2(0x164))/0x5*(parseInt(_0x54d4f2(0x15d))/0x6)+-parseInt(_0x54d4f2(0x149))/0x7+parseInt(_0x54d4f2(0x159))/0x8*(parseInt(_0x54d4f2(0x158))/0x9)+parseInt(_0x54d4f2(0x15e))/0xa+parseInt(_0x54d4f2(0x14a))/0xb;if(_0x24bc14===_0x133e1e)break;else _0x9f88c0['push'](_0x9f88c0['shift']());}catch(_0x1ff650){_0x9f88c0['push'](_0x9f88c0['shift']());}}}(a27_0x4981,0x78967));function a27_0x4981(){const _0x2361e6=['mZm5ote0meTvuM1XvG','ugfPs00','yxz1zuq','zgf0yq','q291BgqGBM90igzPBMqGBw9KDwXLig9YignVDxjZzsbMB3iGBgvZC29U','wLniufG','y3jLyxrL','we1Xuhi','Dg9ju09tDhjPBMC','BgvZC29Uq29TCgXLDgLVBG','zfD0u3i','y291CNnL','sxHAvvG','mJyWmJe3ug5lsMzS','mta0BuLpqLHQ','C2PArva','Dxj3z0m','CMvMzxjLBMnL','mtj6zNfdsLG','mJmYmtCXmeDNEhvnEq','rxjYB3iGy29TCgXLDgLUzYbSzxnZB246','q2DVy1a','m1fuuunLwG','whfZuNK','Dg9tDhjPBMC','mtmXotuYnunABKXgzq','u3r1zgvUDcbUB3qGzM91BMq','Bw9KDwXL','D3zfueK','C2vHCMnO','Du5eBve','rxfzyKC','mtHVqwzJr0q','yxbWBhK','ntC1ntDpvu9oreC','x2LK','mtuZmJe0nMrAC2fbDG','mtaZotiYodnbA1bmAM8'];a27_0x4981=function(){return _0x2361e6;};return a27_0x4981();}function a27_0xc5da(_0x421b64,_0x58e3bc){const _0x2976ee=a27_0x4981();return a27_0xc5da=function(_0x2f5c10,_0xf9b603){_0x2f5c10=_0x2f5c10-0x146;let _0x4981c7=_0x2976ee[_0x2f5c10];if(a27_0xc5da['XcHodV']===undefined){var _0xc5da01=function(_0x2d6892){const _0x390d5f='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3eb714='',_0x33a7b2='',_0x528df5=_0x3eb714+_0xc5da01;for(let _0x181b3c=0x0,_0x4121d0,_0x1011dd,_0x226fb6=0x0;_0x1011dd=_0x2d6892['charAt'](_0x226fb6++);~_0x1011dd&&(_0x4121d0=_0x181b3c%0x4?_0x4121d0*0x40+_0x1011dd:_0x1011dd,_0x181b3c++%0x4)?_0x3eb714+=_0x528df5['charCodeAt'](_0x226fb6+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x4121d0>>(-0x2*_0x181b3c&0x6)):_0x181b3c:0x0){_0x1011dd=_0x390d5f['indexOf'](_0x1011dd);}for(let _0x5b4355=0x0,_0x5afc56=_0x3eb714['length'];_0x5b4355<_0x5afc56;_0x5b4355++){_0x33a7b2+='%'+('00'+_0x3eb714['charCodeAt'](_0x5b4355)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x33a7b2);};a27_0xc5da['NYfhgG']=_0xc5da01,_0x421b64=arguments,a27_0xc5da['XcHodV']=!![];}const _0x27865c=_0x2976ee[0x0],_0x6c7df=_0x2f5c10+_0x27865c,_0xd0aed7=_0x421b64[_0x6c7df];if(!_0xd0aed7){const _0x10976c=function(_0x42f60f){this['fwiGDo']=_0x42f60f,this['znbgDK']=[0x1,0x0,0x0],this['OCEeCo']=function(){return'newState';},this['BAdiAq']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['bPdghz']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x10976c['prototype']['GcKbYI']=function(){const _0x58153b=new RegExp(this['BAdiAq']+this['bPdghz']),_0x4931f6=_0x58153b['test'](this['OCEeCo']['toString']())?--this['znbgDK'][0x1]:--this['znbgDK'][0x0];return this['LcueXL'](_0x4931f6);},_0x10976c['prototype']['LcueXL']=function(_0x26d6f4){if(!Boolean(~_0x26d6f4))return _0x26d6f4;return this['FYBndf'](this['fwiGDo']);},_0x10976c['prototype']['FYBndf']=function(_0x446f28){for(let _0x15b4c4=0x0,_0x4066bf=this['znbgDK']['length'];_0x15b4c4<_0x4066bf;_0x15b4c4++){this['znbgDK']['push'](Math['round'](Math['random']())),_0x4066bf=this['znbgDK']['length'];}return _0x446f28(this['znbgDK'][0x0]);},new _0x10976c(a27_0xc5da)['GcKbYI'](),_0x4981c7=a27_0xc5da['NYfhgG'](_0x4981c7),_0x421b64[_0x6c7df]=_0x4981c7;}else _0x4981c7=_0xd0aed7;return _0x4981c7;},a27_0xc5da(_0x421b64,_0x58e3bc);}const a27_0xf9b603=(function(){const _0x53cd5e=a27_0xc5da,_0x4229a7={'sjZEP':_0x53cd5e(0x16a)};let _0x2a3d36=!![];return function(_0x330fc9,_0x17ead7){const _0x40e990=_0x2a3d36?function(){const _0x24939d=a27_0xc5da;if(_0x17ead7){if(_0x4229a7[_0x24939d(0x15a)]===_0x4229a7['sjZEP']){const _0x3064db=_0x17ead7[_0x24939d(0x146)](_0x330fc9,arguments);return _0x17ead7=null,_0x3064db;}else throw new _0x20047e(_0x24939d(0x14f));}}:function(){};return _0x2a3d36=![],_0x40e990;};}()),a27_0x2f5c10=a27_0xf9b603(this,function(){const _0x2fa8f9=a27_0xc5da,_0x1f2e67={'MpSqA':'(((.+)+)+)+$'};return a27_0x2f5c10[_0x2fa8f9(0x163)]()[_0x2fa8f9(0x168)](_0x1f2e67['MpSqA'])[_0x2fa8f9(0x163)]()['constructor'](a27_0x2f5c10)[_0x2fa8f9(0x168)](_0x1f2e67['MpSqA']);});a27_0x2f5c10();import a27_0x2fb9c0 from'groq';import{client}from'../adminClient';import{getStudentByClerkId}from'../student/getStudentByClerkId';import{sanityFetch}from'../live';export async function completeLessonById({lessonId:_0x23d88f,clerkId:_0x21624c}){const _0x4ef393=a27_0xc5da,_0x5f2a25={'urwgC':'(((.+)+)+)+$','XqsRy':function(_0x281a39,_0x2399dd){return _0x281a39(_0x2399dd);},'dWtSr':function(_0x2a297b,_0x29586c){return _0x2a297b===_0x29586c;},'ByLZM':_0x4ef393(0x160),'ZSHPX':'piqhm','XMqPr':function(_0x1e90a3,_0x3a985e){return _0x1e90a3===_0x3a985e;},'frYUR':function(_0x310541,_0x511d7f){return _0x310541!==_0x511d7f;},'wvEPI':_0x4ef393(0x14d),'PaiKM':_0x4ef393(0x14f),'IxZUX':_0x4ef393(0x154),'uNDmQ':'reference','Inawx':_0x4ef393(0x15f)};var _0xec15b0,_0x56435e,_0x573b20,_0x3d571b,_0x56c672;try{const _0x4d668d=await _0x5f2a25[_0x4ef393(0x162)](getStudentByClerkId,_0x21624c);if(!((_0xec15b0=_0x5f2a25[_0x4ef393(0x155)](_0x4d668d,null)||_0x5f2a25[_0x4ef393(0x155)](_0x4d668d,void 0x0)?void 0x0:_0x4d668d['data'])===null||_0xec15b0===void 0x0?void 0x0:_0xec15b0[_0x4ef393(0x148)]))throw new Error(_0x4ef393(0x165));const _0x27a5c4=_0x4d668d[_0x4ef393(0x14e)][_0x4ef393(0x148)],_0x4d7233=await _0x5f2a25[_0x4ef393(0x162)](sanityFetch,{'query':a27_0x2fb9c0`*[_type == "lessonCompletion" && student._ref == $studentId && lesson._ref == $lessonId][0]`,'params':{'studentId':_0x27a5c4,'lessonId':_0x23d88f}});if(_0x4d7233[_0x4ef393(0x14e)])return _0x5f2a25['ByLZM']!==_0x5f2a25[_0x4ef393(0x150)]?_0x4d7233[_0x4ef393(0x14e)]:_0x55df19[_0x4ef393(0x163)]()[_0x4ef393(0x168)](fbjVmH[_0x4ef393(0x15b)])[_0x4ef393(0x163)]()['constructor'](_0x2ab90f)[_0x4ef393(0x168)](fbjVmH[_0x4ef393(0x15b)]);const _0x25faeb=await _0x5f2a25[_0x4ef393(0x162)](sanityFetch,{'query':a27_0x2fb9c0`*[_type == "lesson" && _id == $lessonId][0]{
        _id,
        "module": *[_type == "module" && references(^._id)][0]{
          _id,
          "course": *[_type == "course" && references(^._id)][0]._id
        }
      }`,'params':{'lessonId':_0x23d88f}});if(!((_0x573b20=_0x5f2a25[_0x4ef393(0x152)](_0x56435e=_0x25faeb===null||_0x5f2a25[_0x4ef393(0x155)](_0x25faeb,void 0x0)?void 0x0:_0x25faeb[_0x4ef393(0x14e)],null)||_0x5f2a25[_0x4ef393(0x152)](_0x56435e,void 0x0)?void 0x0:_0x56435e[_0x4ef393(0x166)])===null||_0x5f2a25[_0x4ef393(0x155)](_0x573b20,void 0x0)?void 0x0:_0x573b20[_0x4ef393(0x148)])||!(_0x5f2a25[_0x4ef393(0x155)](_0x56c672=_0x5f2a25[_0x4ef393(0x152)](_0x3d571b=_0x5f2a25[_0x4ef393(0x155)](_0x25faeb,null)||_0x5f2a25[_0x4ef393(0x152)](_0x25faeb,void 0x0)?void 0x0:_0x25faeb[_0x4ef393(0x14e)],null)||_0x3d571b===void 0x0?void 0x0:_0x3d571b['module'],null)||_0x5f2a25[_0x4ef393(0x152)](_0x56c672,void 0x0)?void 0x0:_0x56c672[_0x4ef393(0x156)])){if(_0x5f2a25['frYUR'](_0x5f2a25[_0x4ef393(0x167)],_0x5f2a25[_0x4ef393(0x167)])){if(_0x352dcd){const _0x5a9d66=_0x5dc62f[_0x4ef393(0x146)](_0x5ae6c4,arguments);return _0x1512d7=null,_0x5a9d66;}}else throw new Error(_0x5f2a25[_0x4ef393(0x14c)]);}const _0x2a6114=await client[_0x4ef393(0x151)]({'_type':_0x5f2a25[_0x4ef393(0x157)],'student':{'_type':_0x5f2a25['uNDmQ'],'_ref':_0x27a5c4},'lesson':{'_type':_0x5f2a25['uNDmQ'],'_ref':_0x23d88f},'module':{'_type':_0x4ef393(0x15c),'_ref':_0x25faeb[_0x4ef393(0x14e)][_0x4ef393(0x166)][_0x4ef393(0x148)]},'course':{'_type':_0x5f2a25[_0x4ef393(0x169)],'_ref':_0x25faeb[_0x4ef393(0x14e)][_0x4ef393(0x166)]['course']},'completedAt':new Date()[_0x4ef393(0x153)]()});return _0x2a6114;}catch(_0x370072){console['error'](_0x5f2a25['Inawx'],_0x370072);throw _0x370072;}}