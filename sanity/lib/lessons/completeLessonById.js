function a8_0x1b8e(_0x291cb4,_0x493c27){const _0x3304c3=a8_0x3304();return a8_0x1b8e=function(_0x1b8e11,_0x16f1ac){_0x1b8e11=_0x1b8e11-0xc0;let _0x5c623b=_0x3304c3[_0x1b8e11];if(a8_0x1b8e['VzzxcK']===undefined){var _0x4e639a=function(_0x59da42){const _0x4ddc0b='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x8760de='',_0x2cd0c0='';for(let _0x5d7f1b=0x0,_0x212c57,_0x340ce6,_0x5a7cf4=0x0;_0x340ce6=_0x59da42['charAt'](_0x5a7cf4++);~_0x340ce6&&(_0x212c57=_0x5d7f1b%0x4?_0x212c57*0x40+_0x340ce6:_0x340ce6,_0x5d7f1b++%0x4)?_0x8760de+=String['fromCharCode'](0xff&_0x212c57>>(-0x2*_0x5d7f1b&0x6)):0x0){_0x340ce6=_0x4ddc0b['indexOf'](_0x340ce6);}for(let _0x1d0750=0x0,_0x55ea20=_0x8760de['length'];_0x1d0750<_0x55ea20;_0x1d0750++){_0x2cd0c0+='%'+('00'+_0x8760de['charCodeAt'](_0x1d0750)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2cd0c0);};a8_0x1b8e['JdvyXi']=_0x4e639a,_0x291cb4=arguments,a8_0x1b8e['VzzxcK']=!![];}const _0x428af4=_0x3304c3[0x0],_0x49f1a0=_0x1b8e11+_0x428af4,_0x50e0dd=_0x291cb4[_0x49f1a0];return!_0x50e0dd?(_0x5c623b=a8_0x1b8e['JdvyXi'](_0x5c623b),_0x291cb4[_0x49f1a0]=_0x5c623b):_0x5c623b=_0x50e0dd,_0x5c623b;},a8_0x1b8e(_0x291cb4,_0x493c27);}function a8_0x3304(){const _0x101dc8=['mJyZme1rA0jPBa','u3r1zgvUDcbUB3qGzM91BMq','mta2ndqXmw5LyLLiEq','mZbXvwrqzui','mJaWEgTIwLrp','zxjYB3i','ndyXmZm1nMjZyMXlwG','mtiZmJCYBMD3y0HH','Bw9KDwXL','mJmYnwXSuKXsyW','nNPRy0THBG','mtm5nty1tfDKqNHf','otq4nZu5n0fwCuPOta','x2LK','zgf0yq','otaWyw5lCen0','y291CNnL','mZK4mdC3mJbAs25oAxG','rxjYB3iGy29TCgXLDgLUzYbSzxnZB246','CMvMzxjLBMnL'];a8_0x3304=function(){return _0x101dc8;};return a8_0x3304();}(function(_0x46e2e0,_0x4f9f5e){const _0x4eb3be=a8_0x1b8e,_0x1386e1=_0x46e2e0();while(!![]){try{const _0xdcd319=-parseInt(_0x4eb3be(0xd3))/0x1+parseInt(_0x4eb3be(0xd1))/0x2*(-parseInt(_0x4eb3be(0xc6))/0x3)+parseInt(_0x4eb3be(0xc1))/0x4*(-parseInt(_0x4eb3be(0xc8))/0x5)+-parseInt(_0x4eb3be(0xc7))/0x6*(-parseInt(_0x4eb3be(0xc9))/0x7)+parseInt(_0x4eb3be(0xc4))/0x8*(-parseInt(_0x4eb3be(0xcc))/0x9)+-parseInt(_0x4eb3be(0xc0))/0xa*(-parseInt(_0x4eb3be(0xc3))/0xb)+parseInt(_0x4eb3be(0xce))/0xc;if(_0xdcd319===_0x4f9f5e)break;else _0x1386e1['push'](_0x1386e1['shift']());}catch(_0x4fbd63){_0x1386e1['push'](_0x1386e1['shift']());}}}(a8_0x3304,0xde5bf));import a8_0x59da42 from'groq';import{client}from'../adminClient';import{getStudentByClerkId}from'../student/getStudentByClerkId';import{sanityFetch}from'../live';export async function completeLessonById({lessonId:_0x4ddc0b,clerkId:_0x8760de}){const _0x1dbedc=a8_0x1b8e;try{const _0x2cd0c0=await getStudentByClerkId(_0x8760de);if(!_0x2cd0c0?.['data']?.[_0x1dbedc(0xca)])throw new Error(_0x1dbedc(0xd2));const _0x5d7f1b=_0x2cd0c0[_0x1dbedc(0xcb)][_0x1dbedc(0xca)],_0x212c57=await sanityFetch({'query':a8_0x59da42`*[_type == "lessonCompletion" && student._ref == $studentId && lesson._ref == $lessonId][0]`,'params':{'studentId':_0x5d7f1b,'lessonId':_0x4ddc0b}});if(_0x212c57['data'])return _0x212c57[_0x1dbedc(0xcb)];const _0x340ce6=await sanityFetch({'query':a8_0x59da42`*[_type == "lesson" && _id == $lessonId][0]{
        _id,
        "module": *[_type == "module" && references(^._id)][0]{
          _id,
          "course": *[_type == "course" && references(^._id)][0]._id
        }
      }`,'params':{'lessonId':_0x4ddc0b}});if(!_0x340ce6?.[_0x1dbedc(0xcb)]?.[_0x1dbedc(0xc5)]?.['_id']||!_0x340ce6?.[_0x1dbedc(0xcb)]?.[_0x1dbedc(0xc5)]?.[_0x1dbedc(0xcd)])throw new Error('Could\x20not\x20find\x20module\x20or\x20course\x20for\x20lesson');const _0x5a7cf4=await client['create']({'_type':'lessonCompletion','student':{'_type':'reference','_ref':_0x5d7f1b},'lesson':{'_type':_0x1dbedc(0xd0),'_ref':_0x4ddc0b},'module':{'_type':_0x1dbedc(0xd0),'_ref':_0x340ce6['data'][_0x1dbedc(0xc5)]['_id']},'course':{'_type':'reference','_ref':_0x340ce6['data']['module']['course']},'completedAt':new Date()['toISOString']()});return _0x5a7cf4;}catch(_0x1d0750){console[_0x1dbedc(0xc2)](_0x1dbedc(0xcf),_0x1d0750);throw _0x1d0750;}}