(function(_0x2ce81f,_0x5079d5){const _0x54f16f=a85_0x4877,_0x47a752=_0x2ce81f();while(!![]){try{const _0x565453=parseInt(_0x54f16f(0xa2))/0x1+-parseInt(_0x54f16f(0xa1))/0x2+-parseInt(_0x54f16f(0xc1))/0x3*(parseInt(_0x54f16f(0xa8))/0x4)+-parseInt(_0x54f16f(0xac))/0x5+-parseInt(_0x54f16f(0xc0))/0x6+-parseInt(_0x54f16f(0xa6))/0x7*(-parseInt(_0x54f16f(0xa0))/0x8)+-parseInt(_0x54f16f(0xb3))/0x9*(-parseInt(_0x54f16f(0xb8))/0xa);if(_0x565453===_0x5079d5)break;else _0x47a752['push'](_0x47a752['shift']());}catch(_0x101035){_0x47a752['push'](_0x47a752['shift']());}}}(a85_0x313f,0x9c41e));function a85_0x313f(){const _0x3ae3a8=['v3rKz0q','vgvlDuO','BfnIs3C','mte3oda4meTvCKT4vG','y291CNnL','tu1Jvg4','Bw9KDwXL','BgvZC29Uq29TCgXLDgLVBG','q291BgqGBM90igzPBMqGBw9KDwXLig9YignVDxjZzsbMB3iGBgvZC29U','kcGOlISPkYKRksSK','mZG3uM9PEMvV','t1vSy2y','y3jLyxrL','u3r1zgvUDcbUB3qGzM91BMq','zgf0yq','ndKWntuWuwPItxfA','y29UC3rYDwn0B3i','x2LK','u2HJAue','sNrHAMO','yxbWBhK','rxjYB3iGy29TCgXLDgLUzYbSzxnZB246','BMDYs2C','nZqYotiWC1H4vgjg','mtC2mw1QBgv0Cq','qwruwu4','BeLVBKi','C2vHCMnO','ntuWnJr5DwLNsMW','mJaXmdK0mhzzDMXRDW','ndu3nZC5qNPPt1zv','D1LZuNu','Dg9tDhjPBMC','CNLJCfO','ntGXAezAEfPS','CMvMzxjLBMnL','nZCYne9nvxznDq'];a85_0x313f=function(){return _0x3ae3a8;};return a85_0x313f();}const a85_0x37fda9=(function(){let _0x392013=!![];return function(_0x9bc91f,_0x460aa6){const _0x17f4e5=_0x392013?function(){const _0x4da17b=a85_0x4877;if(_0x460aa6){const _0x389c14=_0x460aa6[_0x4da17b(0xbd)](_0x9bc91f,arguments);return _0x460aa6=null,_0x389c14;}}:function(){};return _0x392013=![],_0x17f4e5;};}()),a85_0x1ffd24=a85_0x37fda9(this,function(){const _0x3aada8=a85_0x4877,_0x206456={'OUlcf':_0x3aada8(0xb2)};return a85_0x1ffd24[_0x3aada8(0xa4)]()[_0x3aada8(0xc4)](_0x206456[_0x3aada8(0xb4)])[_0x3aada8(0xa4)]()[_0x3aada8(0xb9)](a85_0x1ffd24)[_0x3aada8(0xc4)](_0x206456[_0x3aada8(0xb4)]);});function a85_0x4877(_0x55dd9f,_0xe419c){const _0x3279de=a85_0x313f();return a85_0x4877=function(_0x1ffd24,_0x37fda9){_0x1ffd24=_0x1ffd24-0xa0;let _0x313fab=_0x3279de[_0x1ffd24];if(a85_0x4877['JRxeJz']===undefined){var _0x487779=function(_0x1d499a){const _0x3907d8='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2a6691='',_0x81ffd7='',_0x1e8b45=_0x2a6691+_0x487779;for(let _0x33ce31=0x0,_0x5b028f,_0x54324c,_0x2b96ac=0x0;_0x54324c=_0x1d499a['charAt'](_0x2b96ac++);~_0x54324c&&(_0x5b028f=_0x33ce31%0x4?_0x5b028f*0x40+_0x54324c:_0x54324c,_0x33ce31++%0x4)?_0x2a6691+=_0x1e8b45['charCodeAt'](_0x2b96ac+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x5b028f>>(-0x2*_0x33ce31&0x6)):_0x33ce31:0x0){_0x54324c=_0x3907d8['indexOf'](_0x54324c);}for(let _0x5359b0=0x0,_0x415ebe=_0x2a6691['length'];_0x5359b0<_0x415ebe;_0x5359b0++){_0x81ffd7+='%'+('00'+_0x2a6691['charCodeAt'](_0x5359b0)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x81ffd7);};a85_0x4877['rFbqEx']=_0x487779,_0x55dd9f=arguments,a85_0x4877['JRxeJz']=!![];}const _0x96b5bd=_0x3279de[0x0],_0x132def=_0x1ffd24+_0x96b5bd,_0xa9c43a=_0x55dd9f[_0x132def];if(!_0xa9c43a){const _0x4c31b0=function(_0x560f5e){this['WTkDNl']=_0x560f5e,this['WqWsfS']=[0x1,0x0,0x0],this['GxOGCZ']=function(){return'newState';},this['eKOjlf']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['UAjpOq']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4c31b0['prototype']['TzFyGv']=function(){const _0x3d9d67=new RegExp(this['eKOjlf']+this['UAjpOq']),_0x59a901=_0x3d9d67['test'](this['GxOGCZ']['toString']())?--this['WqWsfS'][0x1]:--this['WqWsfS'][0x0];return this['xIZbvx'](_0x59a901);},_0x4c31b0['prototype']['xIZbvx']=function(_0x1687fc){if(!Boolean(~_0x1687fc))return _0x1687fc;return this['gtrTMU'](this['WTkDNl']);},_0x4c31b0['prototype']['gtrTMU']=function(_0x3eed1d){for(let _0x21d3ee=0x0,_0x41d602=this['WqWsfS']['length'];_0x21d3ee<_0x41d602;_0x21d3ee++){this['WqWsfS']['push'](Math['round'](Math['random']())),_0x41d602=this['WqWsfS']['length'];}return _0x3eed1d(this['WqWsfS'][0x0]);},new _0x4c31b0(a85_0x4877)['TzFyGv'](),_0x313fab=a85_0x4877['rFbqEx'](_0x313fab),_0x55dd9f[_0x132def]=_0x313fab;}else _0x313fab=_0xa9c43a;return _0x313fab;},a85_0x4877(_0x55dd9f,_0xe419c);}a85_0x1ffd24();import a85_0x1d250b from'groq';import{client}from'../adminClient';import{getStudentByClerkId}from'../student/getStudentByClerkId';import{sanityFetch}from'../live';export async function completeLessonById({lessonId:_0xa79c75,clerkId:_0x1d218a}){const _0x41e79c=a85_0x4877,_0x267738={'MMcTn':function(_0x47d3d9,_0x4430fa){return _0x47d3d9===_0x4430fa;},'AdTYN':_0x41e79c(0xbc),'dFODr':_0x41e79c(0xab),'RSTqb':_0x41e79c(0xb6),'ngrKg':function(_0xa8c95f,_0x2d2c9c){return _0xa8c95f(_0x2d2c9c);},'wYsRu':function(_0x50acc1,_0x5ac17a){return _0x50acc1!==_0x5ac17a;},'rycpZ':_0x41e79c(0xbb),'TeKuJ':'UPNeE','FLlRo':_0x41e79c(0xb1),'yGAUO':_0x41e79c(0xb0),'WtdgD':_0x41e79c(0xa7),'lIonB':_0x41e79c(0xbe)};try{if(_0x267738[_0x41e79c(0xae)](_0x267738[_0x41e79c(0xc2)],_0x267738['dFODr']))return _0x4d89f9[_0x41e79c(0xb7)];else{const _0x408cfd=await getStudentByClerkId(_0x1d218a);if(!_0x408cfd?.[_0x41e79c(0xb7)]?.[_0x41e79c(0xba)])throw new Error(_0x267738['RSTqb']);const _0x2a04a8=_0x408cfd[_0x41e79c(0xb7)][_0x41e79c(0xba)],_0x2fb062=await sanityFetch({'query':a85_0x1d250b`*[_type == "lessonCompletion" && student._ref == $studentId && lesson._ref == $lessonId][0]`,'params':{'studentId':_0x2a04a8,'lessonId':_0xa79c75}});if(_0x2fb062['data'])return _0x2fb062[_0x41e79c(0xb7)];const _0x577321=await _0x267738[_0x41e79c(0xbf)](sanityFetch,{'query':a85_0x1d250b`*[_type == "lesson" && _id == $lessonId][0]{
        _id,
        "module": *[_type == "module" && references(^._id)][0]{
          _id,
          "course": *[_type == "course" && references(^._id)][0]._id
        }
      }`,'params':{'lessonId':_0xa79c75}});if(!_0x577321?.[_0x41e79c(0xb7)]?.[_0x41e79c(0xaf)]?.[_0x41e79c(0xba)]||!_0x577321?.['data']?.[_0x41e79c(0xaf)]?.[_0x41e79c(0xad)]){if(_0x267738[_0x41e79c(0xa3)](_0x267738[_0x41e79c(0xa5)],_0x267738[_0x41e79c(0xaa)]))throw new Error(_0x267738['FLlRo']);else{const _0x3f4b24=_0x5359b0?function(){const _0x3bc24f=_0x41e79c;if(_0x1687fc){const _0x2e0268=_0x3d27a3[_0x3bc24f(0xbd)](_0x4d2d28,arguments);return _0x50521f=null,_0x2e0268;}}:function(){};return _0x59a901=![],_0x3f4b24;}}const _0x2499fb=await client[_0x41e79c(0xb5)]({'_type':_0x267738['yGAUO'],'student':{'_type':'reference','_ref':_0x2a04a8},'lesson':{'_type':_0x267738[_0x41e79c(0xa9)],'_ref':_0xa79c75},'module':{'_type':_0x267738[_0x41e79c(0xa9)],'_ref':_0x577321[_0x41e79c(0xb7)]['module'][_0x41e79c(0xba)]},'course':{'_type':_0x41e79c(0xa7),'_ref':_0x577321[_0x41e79c(0xb7)]['module'][_0x41e79c(0xad)]},'completedAt':new Date()['toISOString']()});return _0x2499fb;}}catch(_0x4eceb4){console['error'](_0x267738[_0x41e79c(0xc3)],_0x4eceb4);throw _0x4eceb4;}}