function a9_0x1f02(){const _0x52c7f9=['nJCXmdy3vNfcvLbM','mtmZmZG0oevjsfDLqW','Bw9KDwXLCW','u3r1zgvUDcbUB3qGzM91BMq','nJiYmZGWsNbNru1Q','ntvHAhjZtem','munrsvvjCG','nduYmtaYsKrSrLby','nZG2mdC0r1LlDgjJ','zgf0yq','m3zdDwDZCW','ode1nJmWrhDMu1Hc','nJy1BhLyDfHK','ndbMrLD0CKu','oty3ofnrz3r5wq'];a9_0x1f02=function(){return _0x52c7f9;};return a9_0x1f02();}(function(_0x59e9e1,_0x1ab18b){const _0x42130e=a9_0x21c1,_0x87ce8=_0x59e9e1();while(!![]){try{const _0x508259=-parseInt(_0x42130e(0x85))/0x1*(-parseInt(_0x42130e(0x87))/0x2)+-parseInt(_0x42130e(0x89))/0x3*(-parseInt(_0x42130e(0x83))/0x4)+parseInt(_0x42130e(0x7c))/0x5*(-parseInt(_0x42130e(0x7e))/0x6)+parseInt(_0x42130e(0x86))/0x7*(-parseInt(_0x42130e(0x7d))/0x8)+-parseInt(_0x42130e(0x7f))/0x9+parseInt(_0x42130e(0x8a))/0xa*(parseInt(_0x42130e(0x84))/0xb)+-parseInt(_0x42130e(0x80))/0xc;if(_0x508259===_0x1ab18b)break;else _0x87ce8['push'](_0x87ce8['shift']());}catch(_0x307ebb){_0x87ce8['push'](_0x87ce8['shift']());}}}(a9_0x1f02,0x38f37));import{defineQuery}from'groq';import{sanityFetch}from'../live';function a9_0x21c1(_0x29c419,_0x2640fd){const _0x1f02af=a9_0x1f02();return a9_0x21c1=function(_0x21c198,_0x57849a){_0x21c198=_0x21c198-0x7c;let _0xbc0cbf=_0x1f02af[_0x21c198];if(a9_0x21c1['QHuioJ']===undefined){var _0x24b594=function(_0x420c0a){const _0x1dc4ce='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4e6582='',_0x345b49='';for(let _0x46b0ee=0x0,_0x26d04c,_0x134c81,_0xe214b6=0x0;_0x134c81=_0x420c0a['charAt'](_0xe214b6++);~_0x134c81&&(_0x26d04c=_0x46b0ee%0x4?_0x26d04c*0x40+_0x134c81:_0x134c81,_0x46b0ee++%0x4)?_0x4e6582+=String['fromCharCode'](0xff&_0x26d04c>>(-0x2*_0x46b0ee&0x6)):0x0){_0x134c81=_0x1dc4ce['indexOf'](_0x134c81);}for(let _0x57db01=0x0,_0x3f96f6=_0x4e6582['length'];_0x57db01<_0x3f96f6;_0x57db01++){_0x345b49+='%'+('00'+_0x4e6582['charCodeAt'](_0x57db01)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x345b49);};a9_0x21c1['fZNdua']=_0x24b594,_0x29c419=arguments,a9_0x21c1['QHuioJ']=!![];}const _0x581323=_0x1f02af[0x0],_0x4144da=_0x21c198+_0x581323,_0xdd4057=_0x29c419[_0x4144da];return!_0xdd4057?(_0xbc0cbf=a9_0x21c1['fZNdua'](_0xbc0cbf),_0x29c419[_0x4144da]=_0xbc0cbf):_0xbc0cbf=_0xdd4057,_0xbc0cbf;},a9_0x21c1(_0x29c419,_0x2640fd);}import{getStudentByClerkId}from'../student/getStudentByClerkId';import{calculateCourseProgress}from'@/lib/courseProgress';export async function getCourseProgress(_0x420c0a,_0x1dc4ce){const _0x3b3dc5=a9_0x21c1,_0x4e6582=await getStudentByClerkId(_0x420c0a);if(!_0x4e6582?.[_0x3b3dc5(0x88)]?.['_id'])throw new Error(_0x3b3dc5(0x82));const _0x345b49=defineQuery('{\x0a\x20\x20\x20\x20\x22completedLessons\x22:\x20*[_type\x20==\x20\x22lessonCompletion\x22\x20&&\x20student._ref\x20==\x20$studentId\x20&&\x20course._ref\x20==\x20$courseId]\x20{\x0a\x20\x20\x20\x20\x20\x20...,\x0a\x20\x20\x20\x20\x20\x20\x22lesson\x22:\x20lesson->{...},\x0a\x20\x20\x20\x20\x20\x20\x22module\x22:\x20module->{...}\x0a\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x22course\x22:\x20*[_type\x20==\x20\x22course\x22\x20&&\x20_id\x20==\x20$courseId][0]\x20{\x0a\x20\x20\x20\x20\x20\x20...,\x0a\x20\x20\x20\x20\x20\x20\x22modules\x22:\x20modules[]->\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20...,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22lessons\x22:\x20lessons[]->\x20{...}\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20}'),_0x46b0ee=await sanityFetch({'query':_0x345b49,'params':{'studentId':_0x4e6582['data']['_id'],'courseId':_0x1dc4ce}}),{completedLessons:completedLessons=[],course:_0x26d04c}=_0x46b0ee['data'],_0x134c81=calculateCourseProgress(_0x26d04c?.[_0x3b3dc5(0x81)]||null,completedLessons);return{'completedLessons':completedLessons,'courseProgress':_0x134c81};}