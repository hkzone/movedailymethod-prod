"use client";

'use client';(function(_0x2af606,_0x2255e4){const _0x19ac92=a9_0x1aab,_0x350500=_0x2af606();while(!![]){try{const _0xa4be0e=-parseInt(_0x19ac92(0x111))/0x1*(parseInt(_0x19ac92(0x105))/0x2)+-parseInt(_0x19ac92(0x11b))/0x3*(-parseInt(_0x19ac92(0x116))/0x4)+-parseInt(_0x19ac92(0x119))/0x5+-parseInt(_0x19ac92(0x118))/0x6*(-parseInt(_0x19ac92(0x107))/0x7)+parseInt(_0x19ac92(0x10a))/0x8+parseInt(_0x19ac92(0x115))/0x9*(parseInt(_0x19ac92(0x10e))/0xa)+-parseInt(_0x19ac92(0x112))/0xb;if(_0xa4be0e===_0x2255e4)break;else _0x350500['push'](_0x350500['shift']());}catch(_0x280365){_0x350500['push'](_0x350500['shift']());}}}(a9_0x1f0b,0x6fc32));import{jsx as a9_0x4b3d76,jsxs as a9_0x18ae03,Fragment as a9_0x550f47}from'react/jsx-runtime';import{Suspense}from'react';import{Loader}from'@/components/ui/loader';import{useSearchParams,useRouter}from'next/navigation';import{useEffect,useState}from'react';import a9_0x307b17 from'next/link';import{checkPaymentStatus}from'@/app/actions/checkPaymentStatus';function a9_0x1aab(_0x51b883,_0x300ef2){const _0x1f0b45=a9_0x1f0b();return a9_0x1aab=function(_0x1aabb4,_0x440a80){_0x1aabb4=_0x1aabb4-0x105;let _0x571e34=_0x1f0b45[_0x1aabb4];return _0x571e34;},a9_0x1aab(_0x51b883,_0x300ef2);}import{CircleCheck}from'lucide-react';import{Button}from'@/components/ui/button';function ProcessingContent(){const _0x37a944=a9_0x1aab,_0x2d993e=useSearchParams(),_0x48fb6e=useRouter(),[_0x5d6d90,_0x2e61df]=useState('processing'),[_0x194458,_0x44250e]=useState(0x0),[_0x18dab8,_0x20c5d1]=useState(''),_0x269747=_0x2d993e['get']('provider')?.['toLowerCase']()||'unknown',_0x1908ae=_0x269747['charAt'](0x0)[_0x37a944(0x10b)]()+_0x269747['slice'](0x1),_0x23f408=_0x2d993e['get']('order');useEffect(()=>{const _0x4850e7=async()=>{const _0x10333a=a9_0x1aab;if(!_0x23f408){_0x2e61df('error'),_0x20c5d1('No\x20order\x20reference\x20provided');return;}try{const _0x322628=await checkPaymentStatus(_0x23f408);if(_0x322628['status']==='completed'){_0x2e61df('success'),_0x20c5d1(_0x322628?.['message']||''),setTimeout(()=>{_0x48fb6e['push']('/my-courses');},0x1388);return;}else{if(_0x322628['status']==='error'){_0x2e61df('failed'),_0x20c5d1(_0x322628?.['message']||'');return;}else _0x2e61df('processing'),_0x20c5d1(_0x322628['message']||'');}}catch(_0x4bdc9f){console['error']('Error\x20checking\x20initial\x20payment\x20status:',_0x4bdc9f),_0x2e61df(_0x10333a(0x113));}};_0x4850e7();},[_0x23f408,_0x48fb6e]),useEffect(()=>{if(_0x5d6d90!=='processing')return;const _0xa3bab8=setInterval(()=>{_0x44250e(_0x2d926a=>_0x2d926a+0x1);},0x3e8),_0x3105d1=setInterval(async()=>{const _0x5ed9f3=a9_0x1aab;if(_0x23f408&&_0x5d6d90==='processing')try{const _0xd4dcb2=await checkPaymentStatus(_0x23f408);_0xd4dcb2['status']===_0x5ed9f3(0x10c)&&(_0x2e61df('success'),_0x20c5d1(_0xd4dcb2['message']||''),setTimeout(()=>{_0x48fb6e['push']('/my-courses');},0x1388));}catch(_0x455381){console['error']('Error\x20in\x20periodic\x20status\x20check:',_0x455381);}},0x7530);let _0x4be0e6=null;if(_0x23f408){console['log']('🔗\x20Establishing\x20SSE\x20connection\x20with\x20sessionId:',_0x23f408);const _0x4e8092='/api/payment-events?sessionId='+encodeURIComponent(_0x23f408);console['log']('🌐\x20SSE\x20URL:',_0x4e8092),_0x4be0e6=new EventSource(_0x4e8092),_0x4be0e6['onopen']=()=>{console['log']('✅\x20SSE\x20connection\x20opened\x20successfully');},_0x4be0e6['onmessage']=_0x4ca91d=>{const _0x2b2966=a9_0x1aab;try{const _0x146f08=JSON['parse'](_0x4ca91d['data']);console[_0x2b2966(0x11c)]('📨\x20Received\x20payment\x20update:',_0x146f08);switch(_0x146f08['type']){case'connected':console[_0x2b2966(0x11c)]('Connected\x20to\x20payment\x20updates');break;case _0x2b2966(0x114):_0x2e61df('success'),_0x20c5d1(_0x146f08['message']),setTimeout(()=>{_0x48fb6e['push']('/my-courses');},0x1388);break;case _0x2b2966(0x108):_0x2e61df('failed'),_0x20c5d1(_0x146f08['message']),setTimeout(()=>{_0x48fb6e['push'](_0x146f08['redirectUrl']);},0xbb8);break;case'payment_pending':_0x20c5d1(_0x146f08['message']);break;}}catch(_0x50e221){console['error']('Error\x20parsing\x20SSE\x20data:',_0x50e221);}},_0x4be0e6['onerror']=_0x17cc20=>{console['error']('❌\x20SSE\x20connection\x20error:',_0x17cc20),console['log']('📊\x20SSE\x20readyState:',_0x4be0e6?.['readyState']),_0x2e61df('still-processing');};}const _0xb016af=[setTimeout(()=>{const _0x195a0a=a9_0x1aab;_0x5d6d90===_0x195a0a(0x113)&&_0x2e61df('still-processing');},0xea60),setTimeout(()=>{const _0x1803d9=a9_0x1aab;(_0x5d6d90==='processing'||_0x5d6d90===_0x1803d9(0x109))&&_0x2e61df('check-email');},0x2bf20)];return()=>{clearInterval(_0xa3bab8),clearInterval(_0x3105d1),_0xb016af['forEach'](_0x2f8a67=>clearTimeout(_0x2f8a67)),_0x4be0e6&&_0x4be0e6['close']();};},[_0x5d6d90,_0x23f408,_0x48fb6e]);const _0x6eee25=()=>{const _0x14a56=_0x37a944;switch(_0x5d6d90){case'success':return{'title':_0x14a56(0x10f),'message':_0x18dab8||'Your\x20payment\x20has\x20been\x20approved!\x20Redirecting...','color':'text-success','bgColor':'bg-success/10','borderColor':'border-success/20'};case'failed':return{'title':'Payment\x20Failed\x20','message':_0x18dab8||'Your\x20payment\x20could\x20not\x20be\x20processed.','color':'text-destructive','bgColor':'bg-destructive/10','borderColor':'border-destructive/20'};case _0x14a56(0x109):return{'title':'Still\x20Processing...','message':_0x18dab8||'Your\x20'+_0x1908ae+'\x20payment\x20is\x20taking\x20a\x20bit\x20longer\x20than\x20usual.\x20This\x20is\x20normal\x20for\x20some\x20payments.','color':'text-warning','bgColor':'bg-warning/10','borderColor':'border-warning/20'};case'check-email':return{'title':_0x14a56(0x10d),'message':'Your\x20payment\x20confirmation\x20will\x20be\x20sent\x20via\x20email.\x20You\x20can\x20also\x20check\x20your\x20course\x20access\x20in\x20\x22My\x20Courses\x22.','color':'text-success','bgColor':'bg-success/10','borderColor':'border-success/20'};default:return{'title':'Processing\x20Your\x20Payment','message':_0x18dab8||'We\x27re\x20confirming\x20your\x20payment\x20with\x20'+_0x1908ae+_0x14a56(0x11a),'color':'text-info','bgColor':'bg-info/10','borderColor':'border-info/20'};}},_0x57745e=_0x6eee25();return a9_0x4b3d76('div',{'className':'min-h-screen flex items-center justify-center px-[5%]','children':a9_0x4b3d76('div',{'className':'container','children':a9_0x18ae03('div',{'className':'max-w-md w-full mx-auto p-8 bg-card text-card-foreground rounded-xl border border-border shadow-lg text-center','children':[a9_0x4b3d76('div',{'className':'mb-6','children':_0x5d6d90===_0x37a944(0x110)?a9_0x4b3d76(CircleCheck,{'className':'w-16 h-16 mx-auto text-success'}):a9_0x4b3d76(Loader,{'className':'w-16 h-16 mx-auto border-t-primary'})}),a9_0x4b3d76('h1',{'className':'text-2xl\x20font-bold\x20mb-4\x20'+_0x57745e['color'],'children':_0x57745e['title']}),a9_0x4b3d76('p',{'className':'mb-6 text-foreground/80','children':_0x57745e['message']}),_0x194458>0x0&&_0x5d6d90==='processing'&&a9_0x18ae03('p',{'className':'text-sm text-muted-foreground mb-4','children':['Time\x20elapsed:\x20',Math['floor'](_0x194458/0x3c),':',(_0x194458%0x3c)['toString']()['padStart'](0x2,'0')]}),a9_0x4b3d76('div',{'className':(_0x57745e['bgColor']||'bg-info/10')+'\x20border\x20'+(_0x57745e['borderColor']||'border-info/20')+'\x20rounded-lg\x20p-4\x20mb-6','children':a9_0x18ae03('div',{'className':'flex items-center','children':[a9_0x4b3d76('div',{'className':'flex-shrink-0','children':_0x5d6d90==='success'?a9_0x4b3d76('svg',{'className':'h-5 w-5 text-success','fill':'none','stroke':'currentColor','viewBox':'0\x200\x2024\x2024','children':a9_0x4b3d76('path',{'strokeLinecap':'round','strokeLinejoin':'round','strokeWidth':0x2,'d':'M9\x2012l2\x202\x204-4m6\x202a9\x209\x200\x2011-18\x200\x209\x209\x200\x200118\x200z'})}):a9_0x4b3d76('svg',{'className':'h-5 w-5 text-info','viewBox':'0\x200\x2020\x2020','fill':'currentColor','children':a9_0x4b3d76('path',{'fillRule':'evenodd','d':'M18\x2010a8\x208\x200\x2011-16\x200\x208\x208\x200\x200116\x200zm-7-4a1\x201\x200\x2011-2\x200\x201\x201\x200\x20012\x200zM9\x209a1\x201\x200\x20000\x202v3a1\x201\x200\x20001\x201h1a1\x201\x200\x20100-2v-3a1\x201\x200\x2000-1-1H9z','clipRule':'evenodd'})})}),a9_0x4b3d76('div',{'className':'ml-3','children':_0x5d6d90==='success'?a9_0x18ae03('p',{'className':'text-sm','children':[a9_0x4b3d76('strong',{'children':'Payment\x20Confirmed!'}),'\x20You\x20now\x20have\x20access\x20to\x20your\x20purchased\x20content.\x20Check\x20your\x20email\x20for\x20the\x20receipt.']}):a9_0x18ae03('p',{'className':'text-sm','children':[a9_0x4b3d76('strong',{'children':'Processing:'}),'\x20We\x27ll\x20update\x20you\x20automatically\x20when\x20your\x20payment\x20is\x20confirmed.\x20You\x27ll\x20also\x20receive\x20an\x20email\x20confirmation.']})})]})}),a9_0x18ae03('div',{'className':'space-y-2 text-sm text-muted-foreground','children':[_0x5d6d90==='processing'&&a9_0x18ae03(a9_0x550f47,{'children':[a9_0x4b3d76('p',{'children':'•\x20Payment\x20confirmation\x20usually\x20takes\x2030-60\x20seconds'}),a9_0x4b3d76('p',{'children':'•\x20You\x27ll\x20receive\x20an\x20email\x20confirmation'}),a9_0x4b3d76('p',{'children':'•\x20Please\x20keep\x20this\x20page\x20open'})]}),_0x5d6d90==='still-processing'&&a9_0x18ae03(a9_0x550f47,{'children':[a9_0x4b3d76('p',{'children':'•\x20Some\x20payments\x20take\x20up\x20to\x203\x20minutes\x20to\x20process'}),a9_0x4b3d76('p',{'children':'•\x20This\x20is\x20normal\x20for\x20international\x20cards'}),a9_0x4b3d76('p',{'children':'•\x20You\x27ll\x20receive\x20email\x20confirmation\x20when\x20complete'})]}),_0x5d6d90==='check-email'&&a9_0x18ae03(a9_0x550f47,{'children':[a9_0x4b3d76('p',{'children':'•\x20Check\x20your\x20email\x20for\x20payment\x20confirmation'}),a9_0x4b3d76('p',{'children':'•\x20Access\x20your\x20courses\x20from\x20the\x20button\x20below'}),a9_0x4b3d76('p',{'children':'•\x20Contact\x20support\x20if\x20you\x20don\x27t\x20receive\x20confirmation'})]}),_0x5d6d90===_0x37a944(0x106)&&a9_0x18ae03(a9_0x550f47,{'children':[a9_0x4b3d76('p',{'children':'•\x20Your\x20payment\x20failed.\x20Please\x20try\x20again.'}),a9_0x4b3d76('p',{'children':'•\x20Contact\x20support\x20if\x20you\x20need\x20help'})]}),_0x5d6d90==='success'&&a9_0x18ae03(a9_0x550f47,{'children':[a9_0x4b3d76('p',{'children':'•\x20Payment\x20confirmed\x20and\x20processed'}),a9_0x4b3d76('p',{'children':'•\x20Course\x20access\x20has\x20been\x20granted'}),a9_0x4b3d76('p',{'children':'•\x20Receipt\x20sent\x20to\x20your\x20email'})]})]}),a9_0x18ae03('div',{'className':'mt-8 space-y-3','children':[_0x5d6d90==='success'&&a9_0x4b3d76(a9_0x307b17,{'href':'/my-courses','children':a9_0x4b3d76(Button,{'className':'w-full','children':'Access\x20My\x20Courses'})}),_0x5d6d90==='check-email'&&a9_0x4b3d76('a',{'href':'/my-courses','className':'w-full bg-primary text-primary-foreground py-2 px-4 rounded-lg hover:bg-primary/90 transition-colors inline-block text-center font-medium','children':'Check\x20My\x20Courses'}),_0x5d6d90!=='success'&&a9_0x4b3d76(a9_0x307b17,{'href':'mailto:support@movedailymethod.com','className':'text-primary hover:text-primary/80 text-sm underline block text-center transition-colors','children':'Need\x20help?\x20Contact\x20Support'})]}),_0x5d6d90==='success'&&a9_0x4b3d76('p',{'className':'text-xs text-muted-foreground pt-2','children':_0x37a944(0x117)})]})})});}export default function ProcessingPage(){return a9_0x4b3d76(Suspense,{'fallback':a9_0x4b3d76(Loader,{}),'children':a9_0x4b3d76(ProcessingContent,{})});}function a9_0x1f0b(){const _0x56532c=['971tuGCCw','2634885PTzycP','processing','payment_approved','35397Znykgt','4xSSuTP','You\x27ll\x20be\x20automatically\x20redirected\x20to\x20your\x20courses\x20in\x205\x20seconds...','123078eemZdn','760755nLMnrb','.\x20This\x20usually\x20takes\x20a\x20few\x20moments.','1089915jAeASq','log','1026udRFqh','failed','105zsFTAf','payment_failed','still-processing','724560taFClg','toUpperCase','completed','Check\x20Your\x20Email','1490iuEUtm','Payment\x20Confirmed!\x20','success'];a9_0x1f0b=function(){return _0x56532c;};return a9_0x1f0b();}
