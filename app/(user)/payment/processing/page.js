"use client";

'use client';(function(_0x2532eb,_0x5b00ed){const _0x4cb7ff=a9_0x51c8,_0x23a272=_0x2532eb();while(!![]){try{const _0x52df1f=parseInt(_0x4cb7ff(0x12c))/0x1*(parseInt(_0x4cb7ff(0x137))/0x2)+-parseInt(_0x4cb7ff(0x122))/0x3*(-parseInt(_0x4cb7ff(0x126))/0x4)+parseInt(_0x4cb7ff(0x11c))/0x5*(-parseInt(_0x4cb7ff(0x129))/0x6)+parseInt(_0x4cb7ff(0x124))/0x7*(parseInt(_0x4cb7ff(0x133))/0x8)+-parseInt(_0x4cb7ff(0x136))/0x9+parseInt(_0x4cb7ff(0x11b))/0xa*(-parseInt(_0x4cb7ff(0x12a))/0xb)+parseInt(_0x4cb7ff(0x123))/0xc;if(_0x52df1f===_0x5b00ed)break;else _0x23a272['push'](_0x23a272['shift']());}catch(_0x4bceb1){_0x23a272['push'](_0x23a272['shift']());}}}(a9_0x2cca,0x96a72));import{jsx as a9_0x221bcd,jsxs as a9_0x5ef4a6,Fragment as a9_0x5d8e51}from'react/jsx-runtime';function a9_0x2cca(){const _0x4b2a4a=['\x20payment\x20is\x20taking\x20a\x20bit\x20longer\x20than\x20usual.\x20This\x20is\x20normal\x20for\x20some\x20payments.','evenodd','❌\x20SSE\x20connection\x20error:','onerror','1905OKqlhA','21462996AvSXfc','7yllwUa','still-processing','236zAFixh','success','📨\x20Received\x20payment\x20update:','4525338npxkwt','11ASMBWp','0\x200\x2024\x2024','979961ZKFINR','•\x20Payment\x20confirmation\x20usually\x20takes\x2030-60\x20seconds','.\x20This\x20usually\x20takes\x20a\x20few\x20moments.','Your\x20payment\x20confirmation\x20will\x20be\x20sent\x20via\x20email.\x20You\x20can\x20also\x20check\x20your\x20course\x20access\x20in\x20\x22My\x20Courses\x22.','payment_failed','Error\x20parsing\x20SSE\x20data:','Payment\x20Confirmed!','2456808bdSNaR','Error\x20in\x20periodic\x20status\x20check:','parse','8754264nCrgPa','2lPVYLm','7691170ltoqXp','5FFmwyl','0\x200\x2020\x2020'];a9_0x2cca=function(){return _0x4b2a4a;};return a9_0x2cca();}import{Suspense}from'react';import{Loader}from'@/components/ui/loader';import{useSearchParams,useRouter}from'next/navigation';import{useEffect,useState}from'react';import a9_0x268d56 from'next/link';import{checkPaymentStatus}from'@/app/actions/checkPaymentStatus';function a9_0x51c8(_0x166cf7,_0x7b475b){const _0x2cca64=a9_0x2cca();return a9_0x51c8=function(_0x51c8ef,_0x3ad240){_0x51c8ef=_0x51c8ef-0x11b;let _0x4d012d=_0x2cca64[_0x51c8ef];return _0x4d012d;},a9_0x51c8(_0x166cf7,_0x7b475b);}import{CircleCheck}from'lucide-react';import{Button}from'@/components/ui/button';function ProcessingContent(){const _0x495ec2=a9_0x51c8,_0x30d544=useSearchParams(),_0x2f1cf4=useRouter(),[_0x2a3a55,_0x261577]=useState('processing'),[_0x2b994f,_0x4fa329]=useState(0x0),[_0xa6b0ef,_0xbcb66e]=useState(''),_0xb8725d=_0x30d544['get']('provider')?.['toLowerCase']()||'unknown',_0xc51ed4=_0xb8725d['charAt'](0x0)['toUpperCase']()+_0xb8725d['slice'](0x1),_0x11ce00=_0x30d544['get']('order');useEffect(()=>{const _0x51658d=async()=>{if(!_0x11ce00){_0x261577('error'),_0xbcb66e('No\x20order\x20reference\x20provided');return;}try{const _0x59b2e9=await checkPaymentStatus(_0x11ce00);if(_0x59b2e9['status']==='completed'){_0x261577('success'),_0xbcb66e(_0x59b2e9?.['message']||''),setTimeout(()=>{_0x2f1cf4['push']('/my-courses');},0x1388);return;}else{if(_0x59b2e9['status']==='error'){_0x261577('failed'),_0xbcb66e(_0x59b2e9?.['message']||'');return;}else _0x261577('processing'),_0xbcb66e(_0x59b2e9['message']||'');}}catch(_0x3765fe){console['error']('Error\x20checking\x20initial\x20payment\x20status:',_0x3765fe),_0x261577('processing');}};_0x51658d();},[_0x11ce00,_0x2f1cf4]),useEffect(()=>{const _0x2b4a87=a9_0x51c8;if(_0x2a3a55!=='processing')return;const _0x3ca0d0=setInterval(()=>{_0x4fa329(_0x3f9caf=>_0x3f9caf+0x1);},0x3e8),_0x400fd7=setInterval(async()=>{const _0x3b67d4=a9_0x51c8;if(_0x11ce00&&_0x2a3a55==='processing')try{const _0x5e8aa9=await checkPaymentStatus(_0x11ce00);_0x5e8aa9['status']==='completed'&&(_0x261577('success'),_0xbcb66e(_0x5e8aa9['message']||''),setTimeout(()=>{_0x2f1cf4['push']('/my-courses');},0x1388));}catch(_0x421c76){console['error'](_0x3b67d4(0x134),_0x421c76);}},0x7530);let _0x353af7=null;if(_0x11ce00){console['log']('🔗\x20Establishing\x20SSE\x20connection\x20with\x20sessionId:',_0x11ce00);const _0x5df300='/api/payment-events?sessionId='+encodeURIComponent(_0x11ce00);console['log']('🌐\x20SSE\x20URL:',_0x5df300),_0x353af7=new EventSource(_0x5df300),_0x353af7['onopen']=()=>{console['log']('✅\x20SSE\x20connection\x20opened\x20successfully');},_0x353af7['onmessage']=_0x4070a5=>{const _0x394dcc=a9_0x51c8;try{const _0x4f8d77=JSON[_0x394dcc(0x135)](_0x4070a5['data']);console['log'](_0x394dcc(0x128),_0x4f8d77);switch(_0x4f8d77['type']){case'connected':console['log']('Connected\x20to\x20payment\x20updates');break;case'payment_approved':_0x261577(_0x394dcc(0x127)),_0xbcb66e(_0x4f8d77['message']),setTimeout(()=>{_0x2f1cf4['push']('/my-courses');},0x1388);break;case _0x394dcc(0x130):_0x261577('failed'),_0xbcb66e(_0x4f8d77['message']),setTimeout(()=>{_0x2f1cf4['push'](_0x4f8d77['redirectUrl']);},0xbb8);break;case'payment_pending':_0xbcb66e(_0x4f8d77['message']);break;}}catch(_0x4087b9){console['error'](_0x394dcc(0x131),_0x4087b9);}},_0x353af7[_0x2b4a87(0x121)]=_0x10d946=>{const _0x26a70d=_0x2b4a87;console['error'](_0x26a70d(0x120),_0x10d946),console['log']('📊\x20SSE\x20readyState:',_0x353af7?.['readyState']),_0x261577(_0x26a70d(0x125));};}const _0x5c993b=[setTimeout(()=>{_0x2a3a55==='processing'&&_0x261577('still-processing');},0xea60),setTimeout(()=>{(_0x2a3a55==='processing'||_0x2a3a55==='still-processing')&&_0x261577('check-email');},0x2bf20)];return()=>{clearInterval(_0x3ca0d0),clearInterval(_0x400fd7),_0x5c993b['forEach'](_0x16af7a=>clearTimeout(_0x16af7a)),_0x353af7&&_0x353af7['close']();};},[_0x2a3a55,_0x11ce00,_0x2f1cf4]);const _0x42b0e8=()=>{const _0x55f34a=a9_0x51c8;switch(_0x2a3a55){case'success':return{'title':'Payment\x20Confirmed!\x20','message':_0xa6b0ef||'Your\x20payment\x20has\x20been\x20approved!\x20Redirecting...','color':'text-success','bgColor':'bg-success/10','borderColor':'border-success/20'};case'failed':return{'title':'Payment\x20Failed\x20','message':_0xa6b0ef||'Your\x20payment\x20could\x20not\x20be\x20processed.','color':'text-destructive','bgColor':'bg-destructive/10','borderColor':'border-destructive/20'};case _0x55f34a(0x125):return{'title':'Still\x20Processing...','message':_0xa6b0ef||'Your\x20'+_0xc51ed4+_0x55f34a(0x11e),'color':'text-warning','bgColor':'bg-warning/10','borderColor':'border-warning/20'};case'check-email':return{'title':'Check\x20Your\x20Email','message':_0x55f34a(0x12f),'color':'text-success','bgColor':'bg-success/10','borderColor':'border-success/20'};default:return{'title':'Processing\x20Your\x20Payment','message':_0xa6b0ef||'We\x27re\x20confirming\x20your\x20payment\x20with\x20'+_0xc51ed4+_0x55f34a(0x12e),'color':'text-info','bgColor':'bg-info/10','borderColor':'border-info/20'};}},_0x147a2a=_0x42b0e8();return a9_0x221bcd('div',{'className':'min-h-screen flex items-center justify-center px-[5%]','children':a9_0x221bcd('div',{'className':'container','children':a9_0x5ef4a6('div',{'className':'max-w-md w-full mx-auto p-8 bg-card text-card-foreground rounded-xl border border-border shadow-lg text-center','children':[a9_0x221bcd('div',{'className':'mb-6','children':_0x2a3a55==='success'?a9_0x221bcd(CircleCheck,{'className':'w-16 h-16 mx-auto text-success'}):a9_0x221bcd(Loader,{'className':'w-16 h-16 mx-auto border-t-primary'})}),a9_0x221bcd('h1',{'className':'text-2xl\x20font-bold\x20mb-4\x20'+_0x147a2a['color'],'children':_0x147a2a['title']}),a9_0x221bcd('p',{'className':'mb-6 text-foreground/80','children':_0x147a2a['message']}),_0x2b994f>0x0&&_0x2a3a55==='processing'&&a9_0x5ef4a6('p',{'className':'text-sm text-muted-foreground mb-4','children':['Time\x20elapsed:\x20',Math['floor'](_0x2b994f/0x3c),':',(_0x2b994f%0x3c)['toString']()['padStart'](0x2,'0')]}),a9_0x221bcd('div',{'className':(_0x147a2a['bgColor']||'bg-info/10')+'\x20border\x20'+(_0x147a2a['borderColor']||'border-info/20')+'\x20rounded-lg\x20p-4\x20mb-6','children':a9_0x5ef4a6('div',{'className':'flex items-center','children':[a9_0x221bcd('div',{'className':'flex-shrink-0','children':_0x2a3a55==='success'?a9_0x221bcd('svg',{'className':'h-5 w-5 text-success','fill':'none','stroke':'currentColor','viewBox':_0x495ec2(0x12b),'children':a9_0x221bcd('path',{'strokeLinecap':'round','strokeLinejoin':'round','strokeWidth':0x2,'d':'M9\x2012l2\x202\x204-4m6\x202a9\x209\x200\x2011-18\x200\x209\x209\x200\x200118\x200z'})}):a9_0x221bcd('svg',{'className':'h-5 w-5 text-info','viewBox':_0x495ec2(0x11d),'fill':'currentColor','children':a9_0x221bcd('path',{'fillRule':_0x495ec2(0x11f),'d':'M18\x2010a8\x208\x200\x2011-16\x200\x208\x208\x200\x200116\x200zm-7-4a1\x201\x200\x2011-2\x200\x201\x201\x200\x20012\x200zM9\x209a1\x201\x200\x20000\x202v3a1\x201\x200\x20001\x201h1a1\x201\x200\x20100-2v-3a1\x201\x200\x2000-1-1H9z','clipRule':'evenodd'})})}),a9_0x221bcd('div',{'className':'ml-3','children':_0x2a3a55==='success'?a9_0x5ef4a6('p',{'className':'text-sm','children':[a9_0x221bcd('strong',{'children':_0x495ec2(0x132)}),'\x20You\x20now\x20have\x20access\x20to\x20your\x20purchased\x20content.\x20Check\x20your\x20email\x20for\x20the\x20receipt.']}):a9_0x5ef4a6('p',{'className':'text-sm','children':[a9_0x221bcd('strong',{'children':'Processing:'}),'\x20We\x27ll\x20update\x20you\x20automatically\x20when\x20your\x20payment\x20is\x20confirmed.\x20You\x27ll\x20also\x20receive\x20an\x20email\x20confirmation.']})})]})}),a9_0x5ef4a6('div',{'className':'space-y-2 text-sm text-muted-foreground','children':[_0x2a3a55==='processing'&&a9_0x5ef4a6(a9_0x5d8e51,{'children':[a9_0x221bcd('p',{'children':_0x495ec2(0x12d)}),a9_0x221bcd('p',{'children':'•\x20You\x27ll\x20receive\x20an\x20email\x20confirmation'}),a9_0x221bcd('p',{'children':'•\x20Please\x20keep\x20this\x20page\x20open'})]}),_0x2a3a55==='still-processing'&&a9_0x5ef4a6(a9_0x5d8e51,{'children':[a9_0x221bcd('p',{'children':'•\x20Some\x20payments\x20take\x20up\x20to\x203\x20minutes\x20to\x20process'}),a9_0x221bcd('p',{'children':'•\x20This\x20is\x20normal\x20for\x20international\x20cards'}),a9_0x221bcd('p',{'children':'•\x20You\x27ll\x20receive\x20email\x20confirmation\x20when\x20complete'})]}),_0x2a3a55==='check-email'&&a9_0x5ef4a6(a9_0x5d8e51,{'children':[a9_0x221bcd('p',{'children':'•\x20Check\x20your\x20email\x20for\x20payment\x20confirmation'}),a9_0x221bcd('p',{'children':'•\x20Access\x20your\x20courses\x20from\x20the\x20button\x20below'}),a9_0x221bcd('p',{'children':'•\x20Contact\x20support\x20if\x20you\x20don\x27t\x20receive\x20confirmation'})]}),_0x2a3a55==='failed'&&a9_0x5ef4a6(a9_0x5d8e51,{'children':[a9_0x221bcd('p',{'children':'•\x20Your\x20payment\x20failed.\x20Please\x20try\x20again.'}),a9_0x221bcd('p',{'children':'•\x20Contact\x20support\x20if\x20you\x20need\x20help'})]}),_0x2a3a55==='success'&&a9_0x5ef4a6(a9_0x5d8e51,{'children':[a9_0x221bcd('p',{'children':'•\x20Payment\x20confirmed\x20and\x20processed'}),a9_0x221bcd('p',{'children':'•\x20Course\x20access\x20has\x20been\x20granted'}),a9_0x221bcd('p',{'children':'•\x20Receipt\x20sent\x20to\x20your\x20email'})]})]}),a9_0x5ef4a6('div',{'className':'mt-8 space-y-3','children':[_0x2a3a55===_0x495ec2(0x127)&&a9_0x221bcd(a9_0x268d56,{'href':'/my-courses','children':a9_0x221bcd(Button,{'className':'w-full','children':'Access\x20My\x20Courses'})}),_0x2a3a55==='check-email'&&a9_0x221bcd('a',{'href':'/my-courses','className':'w-full bg-primary text-primary-foreground py-2 px-4 rounded-lg hover:bg-primary/90 transition-colors inline-block text-center font-medium','children':'Check\x20My\x20Courses'}),_0x2a3a55!=='success'&&a9_0x221bcd(a9_0x268d56,{'href':'mailto:support@movedailymethod.com','className':'text-primary hover:text-primary/80 text-sm underline block text-center transition-colors','children':'Need\x20help?\x20Contact\x20Support'})]}),_0x2a3a55==='success'&&a9_0x221bcd('p',{'className':'text-xs text-muted-foreground pt-2','children':'You\x27ll\x20be\x20automatically\x20redirected\x20to\x20your\x20courses\x20in\x205\x20seconds...'})]})})});}export default function ProcessingPage(){return a9_0x221bcd(Suspense,{'fallback':a9_0x221bcd(Loader,{}),'children':a9_0x221bcd(ProcessingContent,{})});}
