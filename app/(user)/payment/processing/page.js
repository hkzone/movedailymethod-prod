"use client";

'use client';(function(_0x12f787,_0x1e9662){const _0x43d845=a9_0x34fa,_0x3ceb56=_0x12f787();while(!![]){try{const _0x4759a1=parseInt(_0x43d845(0xe4))/0x1*(parseInt(_0x43d845(0xe1))/0x2)+parseInt(_0x43d845(0xd6))/0x3+parseInt(_0x43d845(0xd7))/0x4+parseInt(_0x43d845(0xdc))/0x5+-parseInt(_0x43d845(0xe0))/0x6+parseInt(_0x43d845(0xe6))/0x7+-parseInt(_0x43d845(0xd5))/0x8;if(_0x4759a1===_0x1e9662)break;else _0x3ceb56['push'](_0x3ceb56['shift']());}catch(_0x2819c8){_0x3ceb56['push'](_0x3ceb56['shift']());}}}(a9_0x566e,0x6d964));import{jsx as a9_0x24e7da,jsxs as a9_0x319dc6,Fragment as a9_0x22eb1f}from'react/jsx-runtime';import{Suspense}from'react';function a9_0x566e(){const _0x473f7d=['div','2417658fjWXKH','1791874zavOQm','Check\x20My\x20Courses','•\x20Some\x20payments\x20take\x20up\x20to\x203\x20minutes\x20to\x20process','1dsaktJ','message','5025916cCaFZb','success','•\x20Receipt\x20sent\x20to\x20your\x20email','Error\x20in\x20periodic\x20status\x20check:','check-email','order','M18\x2010a8\x208\x200\x2011-16\x200\x208\x208\x200\x200116\x200zm-7-4a1\x201\x200\x2011-2\x200\x201\x201\x200\x20012\x200zM9\x209a1\x201\x200\x20000\x202v3a1\x201\x200\x20001\x201h1a1\x201\x200\x20100-2v-3a1\x201\x200\x2000-1-1H9z','19458056tUQaBf','2306673JqPbcB','2130948jbOjKk','Check\x20Your\x20Email','error','still-processing','status','1842575RgRkjO','close','failed'];a9_0x566e=function(){return _0x473f7d;};return a9_0x566e();}import{Loader}from'@/components/ui/loader';import{useSearchParams,useRouter}from'next/navigation';import{useEffect,useState}from'react';function a9_0x34fa(_0x2cd1ce,_0xc761e3){const _0x566e0a=a9_0x566e();return a9_0x34fa=function(_0x34faf3,_0x389a2a){_0x34faf3=_0x34faf3-0xd4;let _0x3f1a41=_0x566e0a[_0x34faf3];return _0x3f1a41;},a9_0x34fa(_0x2cd1ce,_0xc761e3);}import a9_0x225ac3 from'next/link';import{checkPaymentStatus}from'@/app/actions/checkPaymentStatus';import{CircleCheck}from'lucide-react';import{Button}from'@/components/ui/button';function ProcessingContent(){const _0x2b55fc=a9_0x34fa,_0x372877=useSearchParams(),_0x33ae10=useRouter(),[_0x16c7ff,_0x2e1506]=useState('processing'),[_0x492746,_0x1a6417]=useState(0x0),[_0x445cdc,_0x2f3635]=useState(''),_0x4ba78f=_0x372877['get']('provider')?.['toLowerCase']()||'unknown',_0x3c65b=_0x4ba78f['charAt'](0x0)['toUpperCase']()+_0x4ba78f['slice'](0x1),_0x1c3961=_0x372877['get'](_0x2b55fc(0xeb));useEffect(()=>{const _0x19ac3d=async()=>{const _0x4e0a75=a9_0x34fa;if(!_0x1c3961){_0x2e1506('error'),_0x2f3635('No\x20order\x20reference\x20provided');return;}try{const _0x3a993e=await checkPaymentStatus(_0x1c3961);if(_0x3a993e['status']==='completed'){_0x2e1506('success'),_0x2f3635(_0x3a993e?.['message']||''),setTimeout(()=>{_0x33ae10['push']('/my-courses');},0x1388);return;}else{if(_0x3a993e[_0x4e0a75(0xdb)]===_0x4e0a75(0xd9)){_0x2e1506('failed'),_0x2f3635(_0x3a993e?.['message']||'');return;}else _0x2e1506('processing'),_0x2f3635(_0x3a993e['message']||'');}}catch(_0x4c34ab){console['error']('Error\x20checking\x20initial\x20payment\x20status:',_0x4c34ab),_0x2e1506('processing');}};_0x19ac3d();},[_0x1c3961,_0x33ae10]),useEffect(()=>{if(_0x16c7ff!=='processing')return;const _0x5662f9=setInterval(()=>{_0x1a6417(_0x426aa6=>_0x426aa6+0x1);},0x3e8),_0x26a2f0=setInterval(async()=>{const _0x163487=a9_0x34fa;if(_0x1c3961&&_0x16c7ff==='processing')try{const _0xd6bbe6=await checkPaymentStatus(_0x1c3961);_0xd6bbe6['status']==='completed'&&(_0x2e1506('success'),_0x2f3635(_0xd6bbe6[_0x163487(0xe5)]||''),setTimeout(()=>{_0x33ae10['push']('/my-courses');},0x1388));}catch(_0x419d72){console['error'](_0x163487(0xe9),_0x419d72);}},0x7530);let _0x2a83a4=null;if(_0x1c3961){console['log']('🔗\x20Establishing\x20SSE\x20connection\x20with\x20sessionId:',_0x1c3961);const _0x2babe6='/api/payment-events?sessionId='+encodeURIComponent(_0x1c3961);console['log']('🌐\x20SSE\x20URL:',_0x2babe6),_0x2a83a4=new EventSource(_0x2babe6),_0x2a83a4['onopen']=()=>{console['log']('✅\x20SSE\x20connection\x20opened\x20successfully');},_0x2a83a4['onmessage']=_0x3d2e99=>{try{const _0x553d3d=JSON['parse'](_0x3d2e99['data']);console['log']('📨\x20Received\x20payment\x20update:',_0x553d3d);switch(_0x553d3d['type']){case'connected':console['log']('Connected\x20to\x20payment\x20updates');break;case'payment_approved':_0x2e1506('success'),_0x2f3635(_0x553d3d['message']),setTimeout(()=>{_0x33ae10['push']('/my-courses');},0x1388);break;case'payment_failed':_0x2e1506('failed'),_0x2f3635(_0x553d3d['message']),setTimeout(()=>{_0x33ae10['push'](_0x553d3d['redirectUrl']);},0xbb8);break;case'payment_pending':_0x2f3635(_0x553d3d['message']);break;}}catch(_0x2403d6){console['error']('Error\x20parsing\x20SSE\x20data:',_0x2403d6);}},_0x2a83a4['onerror']=_0x278dfc=>{const _0x47dedf=a9_0x34fa;console['error']('❌\x20SSE\x20connection\x20error:',_0x278dfc),console['log']('📊\x20SSE\x20readyState:',_0x2a83a4?.['readyState']),_0x2e1506(_0x47dedf(0xda));};}const _0x1ae05f=[setTimeout(()=>{_0x16c7ff==='processing'&&_0x2e1506('still-processing');},0xea60),setTimeout(()=>{const _0xbcde79=a9_0x34fa;(_0x16c7ff==='processing'||_0x16c7ff==='still-processing')&&_0x2e1506(_0xbcde79(0xea));},0x2bf20)];return()=>{const _0x1fe474=a9_0x34fa;clearInterval(_0x5662f9),clearInterval(_0x26a2f0),_0x1ae05f['forEach'](_0x4ddccb=>clearTimeout(_0x4ddccb)),_0x2a83a4&&_0x2a83a4[_0x1fe474(0xdd)]();};},[_0x16c7ff,_0x1c3961,_0x33ae10]);const _0x2dd9e3=()=>{const _0x54cb01=_0x2b55fc;switch(_0x16c7ff){case'success':return{'title':'Payment\x20Confirmed!\x20','message':_0x445cdc||'Your\x20payment\x20has\x20been\x20approved!\x20Redirecting...','color':'text-success','bgColor':'bg-success/10','borderColor':'border-success/20'};case _0x54cb01(0xde):return{'title':'Payment\x20Failed\x20','message':_0x445cdc||'Your\x20payment\x20could\x20not\x20be\x20processed.','color':'text-destructive','bgColor':'bg-destructive/10','borderColor':'border-destructive/20'};case'still-processing':return{'title':'Still\x20Processing...','message':_0x445cdc||'Your\x20'+_0x3c65b+'\x20payment\x20is\x20taking\x20a\x20bit\x20longer\x20than\x20usual.\x20This\x20is\x20normal\x20for\x20some\x20payments.','color':'text-warning','bgColor':'bg-warning/10','borderColor':'border-warning/20'};case'check-email':return{'title':_0x54cb01(0xd8),'message':'Your\x20payment\x20confirmation\x20will\x20be\x20sent\x20via\x20email.\x20You\x20can\x20also\x20check\x20your\x20course\x20access\x20in\x20\x22My\x20Courses\x22.','color':'text-success','bgColor':'bg-success/10','borderColor':'border-success/20'};default:return{'title':'Processing\x20Your\x20Payment','message':_0x445cdc||'We\x27re\x20confirming\x20your\x20payment\x20with\x20'+_0x3c65b+'.\x20This\x20usually\x20takes\x20a\x20few\x20moments.','color':'text-info','bgColor':'bg-info/10','borderColor':'border-info/20'};}},_0x502a8b=_0x2dd9e3();return a9_0x24e7da('div',{'className':'min-h-screen flex items-center justify-center px-[5%]','children':a9_0x24e7da('div',{'className':'container','children':a9_0x319dc6('div',{'className':'max-w-md w-full mx-auto p-8 bg-card text-card-foreground rounded-xl border border-border shadow-lg text-center','children':[a9_0x24e7da('div',{'className':'mb-6','children':_0x16c7ff==='success'?a9_0x24e7da(CircleCheck,{'className':'w-16 h-16 mx-auto text-success'}):a9_0x24e7da(Loader,{'className':'w-16 h-16 mx-auto border-t-primary'})}),a9_0x24e7da('h1',{'className':'text-2xl\x20font-bold\x20mb-4\x20'+_0x502a8b['color'],'children':_0x502a8b['title']}),a9_0x24e7da('p',{'className':'mb-6 text-foreground/80','children':_0x502a8b[_0x2b55fc(0xe5)]}),_0x492746>0x0&&_0x16c7ff==='processing'&&a9_0x319dc6('p',{'className':'text-sm text-muted-foreground mb-4','children':['Time\x20elapsed:\x20',Math['floor'](_0x492746/0x3c),':',(_0x492746%0x3c)['toString']()['padStart'](0x2,'0')]}),a9_0x24e7da('div',{'className':(_0x502a8b['bgColor']||'bg-info/10')+'\x20border\x20'+(_0x502a8b['borderColor']||'border-info/20')+'\x20rounded-lg\x20p-4\x20mb-6','children':a9_0x319dc6('div',{'className':'flex items-center','children':[a9_0x24e7da('div',{'className':'flex-shrink-0','children':_0x16c7ff===_0x2b55fc(0xe7)?a9_0x24e7da('svg',{'className':'h-5 w-5 text-success','fill':'none','stroke':'currentColor','viewBox':'0\x200\x2024\x2024','children':a9_0x24e7da('path',{'strokeLinecap':'round','strokeLinejoin':'round','strokeWidth':0x2,'d':'M9\x2012l2\x202\x204-4m6\x202a9\x209\x200\x2011-18\x200\x209\x209\x200\x200118\x200z'})}):a9_0x24e7da('svg',{'className':'h-5 w-5 text-info','viewBox':'0\x200\x2020\x2020','fill':'currentColor','children':a9_0x24e7da('path',{'fillRule':'evenodd','d':_0x2b55fc(0xd4),'clipRule':'evenodd'})})}),a9_0x24e7da('div',{'className':'ml-3','children':_0x16c7ff==='success'?a9_0x319dc6('p',{'className':'text-sm','children':[a9_0x24e7da('strong',{'children':'Payment\x20Confirmed!'}),'\x20You\x20now\x20have\x20access\x20to\x20your\x20purchased\x20content.\x20Check\x20your\x20email\x20for\x20the\x20receipt.']}):a9_0x319dc6('p',{'className':'text-sm','children':[a9_0x24e7da('strong',{'children':'Processing:'}),'\x20We\x27ll\x20update\x20you\x20automatically\x20when\x20your\x20payment\x20is\x20confirmed.\x20You\x27ll\x20also\x20receive\x20an\x20email\x20confirmation.']})})]})}),a9_0x319dc6(_0x2b55fc(0xdf),{'className':'space-y-2 text-sm text-muted-foreground','children':[_0x16c7ff==='processing'&&a9_0x319dc6(a9_0x22eb1f,{'children':[a9_0x24e7da('p',{'children':'•\x20Payment\x20confirmation\x20usually\x20takes\x2030-60\x20seconds'}),a9_0x24e7da('p',{'children':'•\x20You\x27ll\x20receive\x20an\x20email\x20confirmation'}),a9_0x24e7da('p',{'children':'•\x20Please\x20keep\x20this\x20page\x20open'})]}),_0x16c7ff==='still-processing'&&a9_0x319dc6(a9_0x22eb1f,{'children':[a9_0x24e7da('p',{'children':_0x2b55fc(0xe3)}),a9_0x24e7da('p',{'children':'•\x20This\x20is\x20normal\x20for\x20international\x20cards'}),a9_0x24e7da('p',{'children':'•\x20You\x27ll\x20receive\x20email\x20confirmation\x20when\x20complete'})]}),_0x16c7ff==='check-email'&&a9_0x319dc6(a9_0x22eb1f,{'children':[a9_0x24e7da('p',{'children':'•\x20Check\x20your\x20email\x20for\x20payment\x20confirmation'}),a9_0x24e7da('p',{'children':'•\x20Access\x20your\x20courses\x20from\x20the\x20button\x20below'}),a9_0x24e7da('p',{'children':'•\x20Contact\x20support\x20if\x20you\x20don\x27t\x20receive\x20confirmation'})]}),_0x16c7ff==='failed'&&a9_0x319dc6(a9_0x22eb1f,{'children':[a9_0x24e7da('p',{'children':'•\x20Your\x20payment\x20failed.\x20Please\x20try\x20again.'}),a9_0x24e7da('p',{'children':'•\x20Contact\x20support\x20if\x20you\x20need\x20help'})]}),_0x16c7ff==='success'&&a9_0x319dc6(a9_0x22eb1f,{'children':[a9_0x24e7da('p',{'children':'•\x20Payment\x20confirmed\x20and\x20processed'}),a9_0x24e7da('p',{'children':'•\x20Course\x20access\x20has\x20been\x20granted'}),a9_0x24e7da('p',{'children':_0x2b55fc(0xe8)})]})]}),a9_0x319dc6('div',{'className':'mt-8 space-y-3','children':[_0x16c7ff==='success'&&a9_0x24e7da(a9_0x225ac3,{'href':'/my-courses','children':a9_0x24e7da(Button,{'className':'w-full','children':'Access\x20My\x20Courses'})}),_0x16c7ff==='check-email'&&a9_0x24e7da('a',{'href':'/my-courses','className':'w-full bg-primary text-primary-foreground py-2 px-4 rounded-lg hover:bg-primary/90 transition-colors inline-block text-center font-medium','children':_0x2b55fc(0xe2)}),_0x16c7ff!=='success'&&a9_0x24e7da(a9_0x225ac3,{'href':'mailto:support@movedailymethod.com','className':'text-primary hover:text-primary/80 text-sm underline block text-center transition-colors','children':'Need\x20help?\x20Contact\x20Support'})]}),_0x16c7ff==='success'&&a9_0x24e7da('p',{'className':'text-xs text-muted-foreground pt-2','children':'You\x27ll\x20be\x20automatically\x20redirected\x20to\x20your\x20courses\x20in\x205\x20seconds...'})]})})});}export default function ProcessingPage(){return a9_0x24e7da(Suspense,{'fallback':a9_0x24e7da(Loader,{}),'children':a9_0x24e7da(ProcessingContent,{})});}
