"use server";

'use server';(function(_0x5c4a17,_0x116bfa){const _0x407ff1=a0_0x5bbe,_0x19d571=_0x5c4a17();while(!![]){try{const _0x7a620f=-parseInt(_0x407ff1(0xca))/0x1*(parseInt(_0x407ff1(0xd0))/0x2)+parseInt(_0x407ff1(0xcf))/0x3+-parseInt(_0x407ff1(0xd5))/0x4*(-parseInt(_0x407ff1(0xc8))/0x5)+-parseInt(_0x407ff1(0xc7))/0x6*(parseInt(_0x407ff1(0xc9))/0x7)+parseInt(_0x407ff1(0xd2))/0x8*(-parseInt(_0x407ff1(0xcb))/0x9)+-parseInt(_0x407ff1(0xd3))/0xa+parseInt(_0x407ff1(0xd6))/0xb*(parseInt(_0x407ff1(0xce))/0xc);if(_0x7a620f===_0x116bfa)break;else _0x19d571['push'](_0x19d571['shift']());}catch(_0x2169af){_0x19d571['push'](_0x19d571['shift']());}}}(a0_0x30ae,0x1fcbf));import{auth}from'@clerk/nextjs/server';function a0_0x5bbe(_0x1b6081,_0x511c4){const _0x30aead=a0_0x30ae();return a0_0x5bbe=function(_0x5bbeb7,_0x5d424f){_0x5bbeb7=_0x5bbeb7-0xc7;let _0x35544e=_0x30aead[_0x5bbeb7];return _0x35544e;},a0_0x5bbe(_0x1b6081,_0x511c4);}import{isBundleEnrolled}from'@/sanity/lib/student/isBundleEnrolled';import{isEnrolledInCourse}from'@/sanity/lib/student/isEnrolledInCourse';export async function checkPaymentStatus(_0x47815e){const _0x3e8d43=a0_0x5bbe;try{const {userId:_0x4b1516}=await auth();if(!_0x4b1516)return{'status':'error','type':_0x3e8d43(0xd4),'message':'User\x20not\x20authenticated'};const _0x42e7c2=_0x47815e['split']('--');if(_0x42e7c2[_0x3e8d43(0xd7)]<0x3)return{'status':'error','type':'unknown','message':'Invalid\x20order\x20reference\x20format'};if(_0x42e7c2[0x0]===_0x3e8d43(0xd1)&&_0x42e7c2['length']>=0x4){const _0x4c73e6=_0x42e7c2[0x1],_0x4cadf1=_0x42e7c2[0x2];if(_0x4cadf1!==_0x4b1516)return{'status':'error','type':'bundle','message':'Order\x20does\x20not\x20belong\x20to\x20current\x20user'};const _0x5490e4=await isBundleEnrolled(_0x4b1516,_0x4c73e6);return _0x5490e4?{'status':'completed','type':'bundle','message':'Bundle\x20enrollment\x20completed\x20successfully!','redirectUrl':_0x3e8d43(0xcc),'bundleId':_0x4c73e6}:{'status':'pending','type':'bundle','bundleId':_0x4c73e6};}else{const _0x10103d=_0x42e7c2[0x0],_0x1b1379=_0x42e7c2[0x1];if(_0x1b1379!==_0x4b1516)return{'status':'error','type':'course','message':'Order\x20does\x20not\x20belong\x20to\x20current\x20user'};const _0xe4ce6b=await isEnrolledInCourse(_0x4b1516,_0x10103d);return _0xe4ce6b?{'status':'completed','type':'course','message':'Course\x20enrollment\x20completed\x20successfully!','redirectUrl':_0x3e8d43(0xcd),'courseId':_0x10103d}:{'status':'pending','type':'course','message':'Course\x20payment\x20is\x20still\x20being\x20processed...','courseId':_0x10103d};}}catch(_0x25be23){return console['error']('Error\x20checking\x20payment\x20status:',_0x25be23),{'status':'error','type':'unknown','message':'Failed\x20to\x20check\x20payment\x20status'};}}function a0_0x30ae(){const _0x197b19=['1015883BdSPnX','length','29058tAwAXt','15hkepfD','28pdaloR','97kYpmDC','9FmSoal','/payment/success?payment_success=true&type=bundle','/payment/success?payment_success=true&type=course','12mbNZpa','499698EraJuO','2662VCKBMY','bundle','607512dDlbFN','130150jemkeS','unknown','145004TyXcfE'];a0_0x30ae=function(){return _0x197b19;};return a0_0x30ae();}
