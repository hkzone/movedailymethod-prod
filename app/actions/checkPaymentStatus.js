"use server";

'use server';(function(_0x352bb8,_0x17c90c){const _0x4dd2a6=a0_0x24fa,_0x53fc6b=_0x352bb8();while(!![]){try{const _0x472d65=parseInt(_0x4dd2a6(0x9b))/0x1+parseInt(_0x4dd2a6(0x9e))/0x2*(parseInt(_0x4dd2a6(0x99))/0x3)+parseInt(_0x4dd2a6(0xa0))/0x4+parseInt(_0x4dd2a6(0x9d))/0x5+-parseInt(_0x4dd2a6(0xa3))/0x6+-parseInt(_0x4dd2a6(0xa2))/0x7+-parseInt(_0x4dd2a6(0x98))/0x8*(-parseInt(_0x4dd2a6(0xa4))/0x9);if(_0x472d65===_0x17c90c)break;else _0x53fc6b['push'](_0x53fc6b['shift']());}catch(_0x37d496){_0x53fc6b['push'](_0x53fc6b['shift']());}}}(a0_0x1326,0xcbf7d));import{auth}from'@clerk/nextjs/server';function a0_0x24fa(_0x4d55b7,_0x21a72f){const _0x13267f=a0_0x1326();return a0_0x24fa=function(_0x24faa6,_0x143a90){_0x24faa6=_0x24faa6-0x98;let _0x247619=_0x13267f[_0x24faa6];return _0x247619;},a0_0x24fa(_0x4d55b7,_0x21a72f);}import{isBundleEnrolled}from'@/sanity/lib/student/isBundleEnrolled';function a0_0x1326(){const _0x390a61=['8562000mFWkre','45yXNjDh','603448PhfjGX','3cEjckv','course','121949MafEAG','error','2777625lbNNrl','3234094HrcWjX','completed','3222872dUEuKG','/payment/success?payment_success=true&type=bundle','8504587GKtgQc'];a0_0x1326=function(){return _0x390a61;};return a0_0x1326();}import{isEnrolledInCourse}from'@/sanity/lib/student/isEnrolledInCourse';export async function checkPaymentStatus(_0x53da41){const _0x42a123=a0_0x24fa;try{const {userId:_0x145926}=await auth();if(!_0x145926)return{'status':'error','type':'unknown','message':'User\x20not\x20authenticated'};const _0x3b4371=_0x53da41['split']('--');if(_0x3b4371['length']<0x3)return{'status':_0x42a123(0x9c),'type':'unknown','message':'Invalid\x20order\x20reference\x20format'};if(_0x3b4371[0x0]==='bundle'&&_0x3b4371['length']>=0x4){const _0x9c04bd=_0x3b4371[0x1],_0x3b197b=_0x3b4371[0x2];if(_0x3b197b!==_0x145926)return{'status':'error','type':'bundle','message':'Order\x20does\x20not\x20belong\x20to\x20current\x20user'};const _0x361092=await isBundleEnrolled(_0x145926,_0x9c04bd);return _0x361092?{'status':'completed','type':'bundle','message':'Bundle\x20enrollment\x20completed\x20successfully!','redirectUrl':_0x42a123(0xa1),'bundleId':_0x9c04bd}:{'status':'pending','type':'bundle','bundleId':_0x9c04bd};}else{const _0x498439=_0x3b4371[0x0],_0x21ae02=_0x3b4371[0x1];if(_0x21ae02!==_0x145926)return{'status':'error','type':_0x42a123(0x9a),'message':'Order\x20does\x20not\x20belong\x20to\x20current\x20user'};const _0x551c13=await isEnrolledInCourse(_0x145926,_0x498439);return _0x551c13?{'status':_0x42a123(0x9f),'type':'course','message':'Course\x20enrollment\x20completed\x20successfully!','redirectUrl':'/payment/success?payment_success=true&type=course','courseId':_0x498439}:{'status':'pending','type':'course','message':'Course\x20payment\x20is\x20still\x20being\x20processed...','courseId':_0x498439};}}catch(_0x3246df){return console['error']('Error\x20checking\x20payment\x20status:',_0x3246df),{'status':'error','type':'unknown','message':'Failed\x20to\x20check\x20payment\x20status'};}}
