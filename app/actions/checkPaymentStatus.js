"use server";

'use server';(function(_0x2bbac5,_0x30beb5){const _0x190c59=a0_0x35e2,_0x59bf43=_0x2bbac5();while(!![]){try{const _0x591f7a=parseInt(_0x190c59(0x1c8))/0x1+-parseInt(_0x190c59(0x1cb))/0x2*(-parseInt(_0x190c59(0x1c9))/0x3)+parseInt(_0x190c59(0x1c4))/0x4+parseInt(_0x190c59(0x1c6))/0x5*(parseInt(_0x190c59(0x1c3))/0x6)+-parseInt(_0x190c59(0x1c1))/0x7*(-parseInt(_0x190c59(0x1bf))/0x8)+parseInt(_0x190c59(0x1ca))/0x9+-parseInt(_0x190c59(0x1c2))/0xa;if(_0x591f7a===_0x30beb5)break;else _0x59bf43['push'](_0x59bf43['shift']());}catch(_0x16f8ff){_0x59bf43['push'](_0x59bf43['shift']());}}}(a0_0x5671,0x3d79c));import{auth}from'@clerk/nextjs/server';import{isBundleEnrolled}from'@/sanity/lib/student/isBundleEnrolled';import{isEnrolledInCourse}from'@/sanity/lib/student/isEnrolledInCourse';function a0_0x35e2(_0x490746,_0x1777d6){const _0x5671dc=a0_0x5671();return a0_0x35e2=function(_0x35e2d3,_0x3f3904){_0x35e2d3=_0x35e2d3-0x1be;let _0x1370bd=_0x5671dc[_0x35e2d3];return _0x1370bd;},a0_0x35e2(_0x490746,_0x1777d6);}function a0_0x5671(){const _0x210ccb=['18atknvD','1080524FNrRNV','completed','755795kTeXHu','split','268359kFGmHA','29001RvvJEj','1663992XLqNom','10FKSxbQ','unknown','760456oFIBWY','course','28xzHUOv','13536140teMgYi'];a0_0x5671=function(){return _0x210ccb;};return a0_0x5671();}export async function checkPaymentStatus(_0x59d9c6){const _0xb676a7=a0_0x35e2;try{const {userId:_0x316b39}=await auth();if(!_0x316b39)return{'status':'error','type':_0xb676a7(0x1be),'message':'User\x20not\x20authenticated'};const _0x1304ac=_0x59d9c6[_0xb676a7(0x1c7)]('--');if(_0x1304ac['length']<0x3)return{'status':'error','type':'unknown','message':'Invalid\x20order\x20reference\x20format'};if(_0x1304ac[0x0]==='bundle'&&_0x1304ac['length']>=0x4){const _0x555e02=_0x1304ac[0x1],_0x1429fd=_0x1304ac[0x2];if(_0x1429fd!==_0x316b39)return{'status':'error','type':'bundle','message':'Order\x20does\x20not\x20belong\x20to\x20current\x20user'};const _0xbc528d=await isBundleEnrolled(_0x316b39,_0x555e02);return _0xbc528d?{'status':_0xb676a7(0x1c5),'type':'bundle','message':'Bundle\x20enrollment\x20completed\x20successfully!','redirectUrl':'/payment/success?payment_success=true&type=bundle','bundleId':_0x555e02}:{'status':'pending','type':'bundle','bundleId':_0x555e02};}else{const _0x59983a=_0x1304ac[0x0],_0x2d260f=_0x1304ac[0x1];if(_0x2d260f!==_0x316b39)return{'status':'error','type':_0xb676a7(0x1c0),'message':'Order\x20does\x20not\x20belong\x20to\x20current\x20user'};const _0x1176e9=await isEnrolledInCourse(_0x316b39,_0x59983a);return _0x1176e9?{'status':'completed','type':'course','message':'Course\x20enrollment\x20completed\x20successfully!','redirectUrl':'/payment/success?payment_success=true&type=course','courseId':_0x59983a}:{'status':'pending','type':'course','message':'Course\x20payment\x20is\x20still\x20being\x20processed...','courseId':_0x59983a};}}catch(_0x7bb16d){return console['error']('Error\x20checking\x20payment\x20status:',_0x7bb16d),{'status':'error','type':_0xb676a7(0x1be),'message':'Failed\x20to\x20check\x20payment\x20status'};}}
