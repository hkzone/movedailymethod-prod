"use server";

'use server';(function(_0x41d50c,_0x3258cc){const _0x1fa113=a0_0x29b3,_0x3f6c17=_0x41d50c();while(!![]){try{const _0x52f736=parseInt(_0x1fa113(0x1cd))/0x1+-parseInt(_0x1fa113(0x1ce))/0x2+parseInt(_0x1fa113(0x1c5))/0x3+-parseInt(_0x1fa113(0x1cc))/0x4*(-parseInt(_0x1fa113(0x1ca))/0x5)+-parseInt(_0x1fa113(0x1cb))/0x6+-parseInt(_0x1fa113(0x1d0))/0x7+parseInt(_0x1fa113(0x1cf))/0x8*(parseInt(_0x1fa113(0x1c9))/0x9);if(_0x52f736===_0x3258cc)break;else _0x3f6c17['push'](_0x3f6c17['shift']());}catch(_0x15e445){_0x3f6c17['push'](_0x3f6c17['shift']());}}}(a0_0xa6b7,0x56a21));function a0_0x29b3(_0xf29564,_0x11d846){const _0xa6b772=a0_0xa6b7();return a0_0x29b3=function(_0x29b356,_0x32c293){_0x29b356=_0x29b356-0x1c5;let _0x423b43=_0xa6b772[_0x29b356];return _0x423b43;},a0_0x29b3(_0xf29564,_0x11d846);}import{auth}from'@clerk/nextjs/server';function a0_0xa6b7(){const _0x157d87=['5JxeDiX','3664002grVTMj','343428fvMwkx','459044MqSkqU','118590cFFXde','264RGxZsT','3241770ZEvSrG','1218627CksKMo','error','pending','/payment/success?payment_success=true&type=course','146403DLzOKn'];a0_0xa6b7=function(){return _0x157d87;};return a0_0xa6b7();}import{isBundleEnrolled}from'@/sanity/lib/student/isBundleEnrolled';import{isEnrolledInCourse}from'@/sanity/lib/student/isEnrolledInCourse';export async function checkPaymentStatus(_0x2f4d5d){const _0x40ca03=a0_0x29b3;try{const {userId:_0x422b23}=await auth();if(!_0x422b23)return{'status':'error','type':'unknown','message':'User\x20not\x20authenticated'};const _0x476ef5=_0x2f4d5d['split']('--');if(_0x476ef5['length']<0x3)return{'status':_0x40ca03(0x1c6),'type':'unknown','message':'Invalid\x20order\x20reference\x20format'};if(_0x476ef5[0x0]==='bundle'&&_0x476ef5['length']>=0x4){const _0x5cf651=_0x476ef5[0x1],_0x24f3dc=_0x476ef5[0x2];if(_0x24f3dc!==_0x422b23)return{'status':'error','type':'bundle','message':'Order\x20does\x20not\x20belong\x20to\x20current\x20user'};const _0xcbfb36=await isBundleEnrolled(_0x422b23,_0x5cf651);return _0xcbfb36?{'status':'completed','type':'bundle','message':'Bundle\x20enrollment\x20completed\x20successfully!','redirectUrl':'/payment/success?payment_success=true&type=bundle','bundleId':_0x5cf651}:{'status':'pending','type':'bundle','bundleId':_0x5cf651};}else{const _0x110ac7=_0x476ef5[0x0],_0x5de802=_0x476ef5[0x1];if(_0x5de802!==_0x422b23)return{'status':'error','type':'course','message':'Order\x20does\x20not\x20belong\x20to\x20current\x20user'};const _0x54aa18=await isEnrolledInCourse(_0x422b23,_0x110ac7);return _0x54aa18?{'status':'completed','type':'course','message':'Course\x20enrollment\x20completed\x20successfully!','redirectUrl':_0x40ca03(0x1c8),'courseId':_0x110ac7}:{'status':_0x40ca03(0x1c7),'type':'course','message':'Course\x20payment\x20is\x20still\x20being\x20processed...','courseId':_0x110ac7};}}catch(_0x3571a6){return console['error']('Error\x20checking\x20payment\x20status:',_0x3571a6),{'status':'error','type':'unknown','message':'Failed\x20to\x20check\x20payment\x20status'};}}
