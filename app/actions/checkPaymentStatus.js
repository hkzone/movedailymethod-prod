"use server";

'use server';(function(_0x4f71d1,_0x2b3638){const _0x4399d6=a0_0x4a0c,_0x2fbb3f=_0x4f71d1();while(!![]){try{const _0x50abde=-parseInt(_0x4399d6(0x75))/0x1*(parseInt(_0x4399d6(0x73))/0x2)+-parseInt(_0x4399d6(0x6f))/0x3*(-parseInt(_0x4399d6(0x72))/0x4)+-parseInt(_0x4399d6(0x7a))/0x5+-parseInt(_0x4399d6(0x76))/0x6+parseInt(_0x4399d6(0x70))/0x7*(parseInt(_0x4399d6(0x7d))/0x8)+-parseInt(_0x4399d6(0x78))/0x9+parseInt(_0x4399d6(0x74))/0xa;if(_0x50abde===_0x2b3638)break;else _0x2fbb3f['push'](_0x2fbb3f['shift']());}catch(_0x39c004){_0x2fbb3f['push'](_0x2fbb3f['shift']());}}}(a0_0x354f,0x31beb));function a0_0x4a0c(_0x75d621,_0x3e804a){const _0x354f6c=a0_0x354f();return a0_0x4a0c=function(_0x4a0cf3,_0x1cd028){_0x4a0cf3=_0x4a0cf3-0x6f;let _0x2cf536=_0x354f6c[_0x4a0cf3];return _0x2cf536;},a0_0x4a0c(_0x75d621,_0x3e804a);}function a0_0x354f(){const _0x41ab0c=['Order\x20does\x20not\x20belong\x20to\x20current\x20user','1251935RhbnRS','Bundle\x20enrollment\x20completed\x20successfully!','bundle','3130848USiivw','222hcCYGO','7cGdDRU','pending','5812WliMZM','26324VnFgub','1733500MxvJYF','13JLhRTV','135204vwWMZX','completed','220014clvpXg'];a0_0x354f=function(){return _0x41ab0c;};return a0_0x354f();}import{auth}from'@clerk/nextjs/server';import{isBundleEnrolled}from'@/sanity/lib/student/isBundleEnrolled';import{isEnrolledInCourse}from'@/sanity/lib/student/isEnrolledInCourse';export async function checkPaymentStatus(_0x380279){const _0x1248b6=a0_0x4a0c;try{const {userId:_0x15bfe6}=await auth();if(!_0x15bfe6)return{'status':'error','type':'unknown','message':'User\x20not\x20authenticated'};const _0x27390f=_0x380279['split']('--');if(_0x27390f['length']<0x3)return{'status':'error','type':'unknown','message':'Invalid\x20order\x20reference\x20format'};if(_0x27390f[0x0]===_0x1248b6(0x7c)&&_0x27390f['length']>=0x4){const _0x36a0f0=_0x27390f[0x1],_0x325b4f=_0x27390f[0x2];if(_0x325b4f!==_0x15bfe6)return{'status':'error','type':'bundle','message':'Order\x20does\x20not\x20belong\x20to\x20current\x20user'};const _0x2a9e55=await isBundleEnrolled(_0x15bfe6,_0x36a0f0);return _0x2a9e55?{'status':_0x1248b6(0x77),'type':'bundle','message':_0x1248b6(0x7b),'redirectUrl':'/payment/success?payment_success=true&type=bundle','bundleId':_0x36a0f0}:{'status':_0x1248b6(0x71),'type':'bundle','bundleId':_0x36a0f0};}else{const _0x1871d7=_0x27390f[0x0],_0x495ab1=_0x27390f[0x1];if(_0x495ab1!==_0x15bfe6)return{'status':'error','type':'course','message':_0x1248b6(0x79)};const _0x174823=await isEnrolledInCourse(_0x15bfe6,_0x1871d7);return _0x174823?{'status':'completed','type':'course','message':'Course\x20enrollment\x20completed\x20successfully!','redirectUrl':'/payment/success?payment_success=true&type=course','courseId':_0x1871d7}:{'status':_0x1248b6(0x71),'type':'course','message':'Course\x20payment\x20is\x20still\x20being\x20processed...','courseId':_0x1871d7};}}catch(_0x53bb96){return console['error']('Error\x20checking\x20payment\x20status:',_0x53bb96),{'status':'error','type':'unknown','message':'Failed\x20to\x20check\x20payment\x20status'};}}
