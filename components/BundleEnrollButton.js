"use client";

'use client';(function(_0x5a15f7,_0x4f6563){const _0x5a3487=a0_0x5b43,_0xcb98b4=_0x5a15f7();while(!![]){try{const _0x47e370=parseInt(_0x5a3487(0x165))/0x1*(-parseInt(_0x5a3487(0x16d))/0x2)+parseInt(_0x5a3487(0x16f))/0x3*(parseInt(_0x5a3487(0x173))/0x4)+parseInt(_0x5a3487(0x167))/0x5+-parseInt(_0x5a3487(0x16b))/0x6*(parseInt(_0x5a3487(0x171))/0x7)+parseInt(_0x5a3487(0x169))/0x8*(parseInt(_0x5a3487(0x168))/0x9)+-parseInt(_0x5a3487(0x16e))/0xa+parseInt(_0x5a3487(0x172))/0xb*(parseInt(_0x5a3487(0x16c))/0xc);if(_0x47e370===_0x4f6563)break;else _0xcb98b4['push'](_0xcb98b4['shift']());}catch(_0x18b492){_0xcb98b4['push'](_0xcb98b4['shift']());}}}(a0_0xf165,0x6e56c));import{jsx as a0_0x4b85b9,jsxs as a0_0x28ca41}from'react/jsx-runtime';function a0_0xf165(){const _0x5a3d8d=['12yicfUG','error','103166tZXNHV','11ieuyAB','493168NeWxUB','createElement','2159zwGRGQ','span','3856710vWAtaf','433071xmBuTM','8VpcNiW','Error\x20in\x20handleEnroll:','102oRQfFe','9828036iYDcby','586RYWueB','7965510XQADSl'];a0_0xf165=function(){return _0x5a3d8d;};return a0_0xf165();}import{createBundleCheckout}from'@/actions/createBundleCheckout';import{createWayforpayBundleCheckout}from'@/actions/createWayforpayBundleCheckout';import{useUser,SignInButton}from'@clerk/nextjs';function a0_0x5b43(_0x304c3e,_0x1477e8){const _0xf16597=a0_0xf165();return a0_0x5b43=function(_0x5b43cf,_0x5f40bc){_0x5b43cf=_0x5b43cf-0x164;let _0x44d085=_0xf16597[_0x5b43cf];return _0x44d085;},a0_0x5b43(_0x304c3e,_0x1477e8);}import{CheckCircle}from'lucide-react';import a0_0x5e843a from'next/link';import{useRouter}from'next/navigation';import{useTransition,useEffect,useState,useRef}from'react';import{AuroraButton}from'./ui/aurora-button';function BundleEnrollButton({bundleId:_0x3dee1d,isEnrolled:_0xea8ed9,ctaText:ctaText='CLAIM\x20DEAL',className:className=''}){const _0x48e2f8=a0_0x5b43,{user:_0x26e91e,isLoaded:_0x4a4174}=useUser(),_0x3a0d6b=useRouter(),[_0x494d32,_0x1ebe30]=useTransition(),[_0x25b9ac,_0x25077d]=useState(![]),_0x4eb55a=useRef(null),_0x29a040=useRef(null);useEffect(()=>{_0x4a4174&&_0x26e91e&&_0x25b9ac&&(_0x29a040['current']&&(clearTimeout(_0x29a040['current']),_0x29a040['current']=null),_0x25077d(![]),setTimeout(()=>{_0x4eb55a['current']?.['scrollIntoView']({'behavior':'instant','block':'center'});},0x64),_0x5230a8(_0x3dee1d));},[_0x4a4174,_0x26e91e,_0x25b9ac,_0x3dee1d]),useEffect(()=>{if(!_0x25b9ac)return;const _0x44f7f5=()=>{const _0xa49653=document['body']['style']['overflow'];_0x25b9ac&&!_0x26e91e&&_0xa49653!=='hidden'&&(_0x29a040['current']=setTimeout(()=>{!_0x26e91e&&_0x25b9ac&&_0x25077d(![]);},0x7d0));},_0x308900=new MutationObserver(_0x44f7f5);return _0x308900['observe'](document['body'],{'attributes':!![],'attributeFilter':['style']}),()=>_0x308900['disconnect']();},[_0x25b9ac,_0x26e91e]);const _0x5230a8=async _0x264713=>{_0x1ebe30(async()=>{const _0x529335=a0_0x5b43;try{const _0x5e27d7=_0x26e91e?.['id'];if(!_0x5e27d7)return;const _0x4cabab=process['env']['NEXT_PUBLIC_PAYMENT_PROVIDER'];let _0x421030;_0x4cabab==='wayforpay'?_0x421030=await createWayforpayBundleCheckout(_0x264713,_0x5e27d7):_0x421030=await createBundleCheckout(_0x264713,_0x5e27d7),_0xf98f1f(_0x421030);}catch(_0x3e3231){console['error'](_0x529335(0x16a),_0x3e3231),alert('Failed\x20to\x20create\x20checkout\x20session.\x20Please\x20try\x20again.'),_0x25077d(![]);}});},_0xf98f1f=_0x5507ed=>{const _0xe49a63=a0_0x5b43;if(!_0x5507ed){alert('Enrollment\x20failed:\x20No\x20result\x20from\x20server.');return;}if(_0x5507ed[_0xe49a63(0x170)]){alert('Enrollment\x20failed:\x20'+_0x5507ed['error']);return;}if(_0x5507ed['type']==='url'&&_0x5507ed['data'])_0x3a0d6b['push'](_0x5507ed['data']);else{if(_0x5507ed['type']==='form'&&_0x5507ed['data']){const _0x2bdcc8=document[_0xe49a63(0x164)]('div');_0x2bdcc8['innerHTML']=_0x5507ed['data'],document['body']['appendChild'](_0x2bdcc8);const _0x137e88=_0x2bdcc8['querySelector']('form');_0x137e88&&_0x137e88['submit']();}else _0x5507ed['type']==='redirect'&&_0x5507ed['data']?_0x3a0d6b['push'](_0x5507ed['data']):alert('Enrollment\x20failed:\x20Unexpected\x20server\x20response.');}};if(_0x25b9ac||_0x494d32)return a0_0x4b85b9('div',{'ref':_0x4eb55a,'children':a0_0x4b85b9(AuroraButton,{'disabled':!![],'className':className,'children':a0_0x28ca41('div',{'className':'flex items-center gap-2','children':[a0_0x4b85b9('div',{'className':'w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin'}),a0_0x4b85b9(_0x48e2f8(0x166),{'children':'Processing\x20enrollment...'})]})})});if(_0xea8ed9)return a0_0x4b85b9('div',{'ref':_0x4eb55a,'children':a0_0x4b85b9(a0_0x5e843a,{'href':'/my-courses','className':className,'children':a0_0x28ca41(AuroraButton,{'children':[a0_0x4b85b9('span',{'children':'Access\x20Courses'}),a0_0x4b85b9(CheckCircle,{'className':'ml-2 w-5 h-5'})]})})});if(!_0x26e91e?.['id']){const _0x1ba196=()=>{_0x25077d(!![]);};return a0_0x4b85b9('div',{'ref':_0x4eb55a,'children':a0_0x4b85b9(SignInButton,{'mode':'modal','children':a0_0x4b85b9(AuroraButton,{'className':className,'onClick':_0x1ba196,'children':ctaText})})});}return a0_0x4b85b9('div',{'ref':_0x4eb55a,'children':a0_0x4b85b9(AuroraButton,{'onClick':()=>_0x5230a8(_0x3dee1d),'className':className,'children':ctaText})});}export default BundleEnrollButton;
