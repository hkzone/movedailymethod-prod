"use client";

'use client';(function(_0x15bdfa,_0x1ca886){const _0x2d6c2e=a0_0x21fb,_0x2660d9=_0x15bdfa();while(!![]){try{const _0x5ae29c=parseInt(_0x2d6c2e(0x127))/0x1+-parseInt(_0x2d6c2e(0x122))/0x2*(parseInt(_0x2d6c2e(0x12c))/0x3)+-parseInt(_0x2d6c2e(0x120))/0x4+-parseInt(_0x2d6c2e(0x12a))/0x5+-parseInt(_0x2d6c2e(0x12f))/0x6*(parseInt(_0x2d6c2e(0x123))/0x7)+parseInt(_0x2d6c2e(0x11f))/0x8*(-parseInt(_0x2d6c2e(0x128))/0x9)+-parseInt(_0x2d6c2e(0x125))/0xa*(-parseInt(_0x2d6c2e(0x12b))/0xb);if(_0x5ae29c===_0x1ca886)break;else _0x2660d9['push'](_0x2660d9['shift']());}catch(_0x535758){_0x2660d9['push'](_0x2660d9['shift']());}}}(a0_0xe2d1,0xd6024));function a0_0x21fb(_0x2883c9,_0x43cd7c){const _0xe2d12d=a0_0xe2d1();return a0_0x21fb=function(_0x21fb6e,_0x2c072e){_0x21fb6e=_0x21fb6e-0x11f;let _0x4917b2=_0xe2d12d[_0x21fb6e];return _0x4917b2;},a0_0x21fb(_0x2883c9,_0x43cd7c);}import{jsx as a0_0x4ab3b1,jsxs as a0_0x69cabc}from'react/jsx-runtime';import{createBundleCheckout}from'@/actions/createBundleCheckout';import{createWayforpayBundleCheckout}from'@/actions/createWayforpayBundleCheckout';import{useUser,SignInButton}from'@clerk/nextjs';import{CheckCircle}from'lucide-react';import a0_0x4037b2 from'next/link';import{useRouter}from'next/navigation';import{useTransition,useEffect,useState,useRef}from'react';import{AuroraButton}from'./ui/aurora-button';function BundleEnrollButton({bundleId:_0x434679,isEnrolled:_0x55a816,ctaText:ctaText='CLAIM\x20DEAL',className:className=''}){const _0x30dbfc=a0_0x21fb,{user:_0x65d068,isLoaded:_0x13d036}=useUser(),_0x12623f=useRouter(),[_0x44b59d,_0x419938]=useTransition(),[_0x1800bc,_0x27275d]=useState(![]),_0x4c1861=useRef(null),_0x4795a6=useRef(null);useEffect(()=>{const _0x5c0b28=a0_0x21fb;_0x13d036&&_0x65d068&&_0x1800bc&&(_0x4795a6['current']&&(clearTimeout(_0x4795a6['current']),_0x4795a6[_0x5c0b28(0x121)]=null),_0x27275d(![]),setTimeout(()=>{_0x4c1861['current']?.['scrollIntoView']({'behavior':'instant','block':'center'});},0x64),_0xb0424a(_0x434679));},[_0x13d036,_0x65d068,_0x1800bc,_0x434679]),useEffect(()=>{if(!_0x1800bc)return;const _0x2715ce=()=>{const _0x181434=document['body']['style']['overflow'];_0x1800bc&&!_0x65d068&&_0x181434!=='hidden'&&(_0x4795a6['current']=setTimeout(()=>{!_0x65d068&&_0x1800bc&&_0x27275d(![]);},0x7d0));},_0x4b25ab=new MutationObserver(_0x2715ce);return _0x4b25ab['observe'](document['body'],{'attributes':!![],'attributeFilter':['style']}),()=>_0x4b25ab['disconnect']();},[_0x1800bc,_0x65d068]);const _0xb0424a=async _0x17ea8d=>{_0x419938(async()=>{try{const _0x1629d5=_0x65d068?.['id'];if(!_0x1629d5)return;const _0x32c041=process['env']['NEXT_PUBLIC_PAYMENT_PROVIDER'];let _0x717176;_0x32c041==='wayforpay'?_0x717176=await createWayforpayBundleCheckout(_0x17ea8d,_0x1629d5):_0x717176=await createBundleCheckout(_0x17ea8d,_0x1629d5),_0x4ccef2(_0x717176);}catch(_0x26b2cb){console['error']('Error\x20in\x20handleEnroll:',_0x26b2cb),alert('Failed\x20to\x20create\x20checkout\x20session.\x20Please\x20try\x20again.'),_0x27275d(![]);}});},_0x4ccef2=_0x43243f=>{const _0xdbb8fd=a0_0x21fb;if(!_0x43243f){alert('Enrollment\x20failed:\x20No\x20result\x20from\x20server.');return;}if(_0x43243f[_0xdbb8fd(0x12e)]){alert('Enrollment\x20failed:\x20'+_0x43243f['error']);return;}if(_0x43243f[_0xdbb8fd(0x130)]==='url'&&_0x43243f['data'])_0x12623f['push'](_0x43243f['data']);else{if(_0x43243f['type']==='form'&&_0x43243f['data']){const _0x13e316=document['createElement']('div');_0x13e316['innerHTML']=_0x43243f['data'],document['body']['appendChild'](_0x13e316);const _0x35035a=_0x13e316[_0xdbb8fd(0x12d)]('form');_0x35035a&&_0x35035a['submit']();}else _0x43243f['type']==='redirect'&&_0x43243f['data']?_0x12623f[_0xdbb8fd(0x124)](_0x43243f['data']):alert('Enrollment\x20failed:\x20Unexpected\x20server\x20response.');}};if(_0x1800bc||_0x44b59d)return a0_0x4ab3b1('div',{'ref':_0x4c1861,'children':a0_0x4ab3b1(AuroraButton,{'disabled':!![],'className':className,'children':a0_0x69cabc('div',{'className':'flex items-center gap-2','children':[a0_0x4ab3b1(_0x30dbfc(0x129),{'className':'w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin'}),a0_0x4ab3b1(_0x30dbfc(0x126),{'children':'Processing\x20enrollment...'})]})})});if(_0x55a816)return a0_0x4ab3b1('div',{'ref':_0x4c1861,'children':a0_0x4ab3b1(a0_0x4037b2,{'href':'/my-courses','className':className,'children':a0_0x69cabc(AuroraButton,{'children':[a0_0x4ab3b1('span',{'children':'Access\x20Courses'}),a0_0x4ab3b1(CheckCircle,{'className':'ml-2 w-5 h-5'})]})})});if(!_0x65d068?.['id']){const _0x3e6038=()=>{_0x27275d(!![]);};return a0_0x4ab3b1('div',{'ref':_0x4c1861,'children':a0_0x4ab3b1(SignInButton,{'mode':'modal','children':a0_0x4ab3b1(AuroraButton,{'className':className,'onClick':_0x3e6038,'children':ctaText})})});}return a0_0x4ab3b1('div',{'ref':_0x4c1861,'children':a0_0x4ab3b1(AuroraButton,{'onClick':()=>_0xb0424a(_0x434679),'className':className,'children':ctaText})});}function a0_0xe2d1(){const _0x143dcb=['189GlEZoi','div','4800845QEBuLU','11pcepms','150cTNEJB','querySelector','error','1230210gUfZOA','type','337680lhXuuK','5358944FAuFAt','current','40930wDDBiV','56YPIlOm','push','51762860eXkKYc','span','1550139KIgvtH'];a0_0xe2d1=function(){return _0x143dcb;};return a0_0xe2d1();}export default BundleEnrollButton;
