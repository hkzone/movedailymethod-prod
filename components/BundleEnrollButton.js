"use client";

'use client';function a0_0x3117(_0x16b0d8,_0x3bd7b5){const _0x10a59d=a0_0x10a5();return a0_0x3117=function(_0x3117fe,_0x5f4515){_0x3117fe=_0x3117fe-0xd4;let _0x237b57=_0x10a59d[_0x3117fe];return _0x237b57;},a0_0x3117(_0x16b0d8,_0x3bd7b5);}(function(_0x580a23,_0x1d514d){const _0x3dd249=a0_0x3117,_0x57a108=_0x580a23();while(!![]){try{const _0x5baa24=parseInt(_0x3dd249(0xda))/0x1+-parseInt(_0x3dd249(0xd9))/0x2+-parseInt(_0x3dd249(0xd4))/0x3+parseInt(_0x3dd249(0xdc))/0x4*(parseInt(_0x3dd249(0xde))/0x5)+parseInt(_0x3dd249(0xd5))/0x6*(-parseInt(_0x3dd249(0xdb))/0x7)+-parseInt(_0x3dd249(0xdd))/0x8*(parseInt(_0x3dd249(0xd8))/0x9)+parseInt(_0x3dd249(0xd7))/0xa;if(_0x5baa24===_0x1d514d)break;else _0x57a108['push'](_0x57a108['shift']());}catch(_0xc2511d){_0x57a108['push'](_0x57a108['shift']());}}}(a0_0x10a5,0xc7068));import{jsx as a0_0x60e11a,jsxs as a0_0x33ae2b}from'react/jsx-runtime';import{createBundleCheckout}from'@/actions/createBundleCheckout';import{createWayforpayBundleCheckout}from'@/actions/createWayforpayBundleCheckout';import{useUser,SignInButton}from'@clerk/nextjs';import{CheckCircle}from'lucide-react';import a0_0x50a0c1 from'next/link';import{useRouter}from'next/navigation';import{useTransition,useEffect,useState,useRef}from'react';import{AuroraButton}from'./ui/aurora-button';function BundleEnrollButton({bundleId:_0x26b369,isEnrolled:_0x412965,ctaText:ctaText='CLAIM\x20DEAL',className:className=''}){const _0x2ec3c9=a0_0x3117,{user:_0x28d592,isLoaded:_0x49d675}=useUser(),_0x3d252c=useRouter(),[_0x2c0382,_0x2b77a4]=useTransition(),[_0x11b02b,_0x3fa493]=useState(![]),_0x46d0c3=useRef(null),_0x5a5244=useRef(null);useEffect(()=>{_0x49d675&&_0x28d592&&_0x11b02b&&(_0x5a5244['current']&&(clearTimeout(_0x5a5244['current']),_0x5a5244['current']=null),_0x3fa493(![]),setTimeout(()=>{_0x46d0c3['current']?.['scrollIntoView']({'behavior':'instant','block':'center'});},0x64),_0x12570d(_0x26b369));},[_0x49d675,_0x28d592,_0x11b02b,_0x26b369]),useEffect(()=>{if(!_0x11b02b)return;const _0x275d2d=()=>{const _0x20eae7=document['body']['style']['overflow'];_0x11b02b&&!_0x28d592&&_0x20eae7!=='hidden'&&(_0x5a5244['current']=setTimeout(()=>{!_0x28d592&&_0x11b02b&&_0x3fa493(![]);},0x7d0));},_0x38f321=new MutationObserver(_0x275d2d);return _0x38f321['observe'](document['body'],{'attributes':!![],'attributeFilter':['style']}),()=>_0x38f321['disconnect']();},[_0x11b02b,_0x28d592]);const _0x12570d=async _0x44434a=>{_0x2b77a4(async()=>{try{const _0x2925a6=_0x28d592?.['id'];if(!_0x2925a6)return;const _0x1caaa8=process['env']['NEXT_PUBLIC_PAYMENT_PROVIDER'];let _0x514f3b;_0x1caaa8==='wayforpay'?_0x514f3b=await createWayforpayBundleCheckout(_0x44434a,_0x2925a6):_0x514f3b=await createBundleCheckout(_0x44434a,_0x2925a6),_0x2d8b78(_0x514f3b);}catch(_0x282dc8){console['error']('Error\x20in\x20handleEnroll:',_0x282dc8),alert('Failed\x20to\x20create\x20checkout\x20session.\x20Please\x20try\x20again.'),_0x3fa493(![]);}});},_0x2d8b78=_0x278b5e=>{if(!_0x278b5e){alert('Enrollment\x20failed:\x20No\x20result\x20from\x20server.');return;}if(_0x278b5e['error']){alert('Enrollment\x20failed:\x20'+_0x278b5e['error']);return;}if(_0x278b5e['type']==='url'&&_0x278b5e['data'])_0x3d252c['push'](_0x278b5e['data']);else{if(_0x278b5e['type']==='form'&&_0x278b5e['data']){const _0x46b8a4=document['createElement']('div');_0x46b8a4['innerHTML']=_0x278b5e['data'],document['body']['appendChild'](_0x46b8a4);const _0x97e17b=_0x46b8a4['querySelector']('form');_0x97e17b&&_0x97e17b['submit']();}else _0x278b5e['type']==='redirect'&&_0x278b5e['data']?_0x3d252c['push'](_0x278b5e['data']):alert('Enrollment\x20failed:\x20Unexpected\x20server\x20response.');}};if(_0x11b02b||_0x2c0382)return a0_0x60e11a('div',{'ref':_0x46d0c3,'children':a0_0x60e11a(AuroraButton,{'disabled':!![],'className':className,'children':a0_0x33ae2b('div',{'className':'flex items-center gap-2','children':[a0_0x60e11a(_0x2ec3c9(0xd6),{'className':'w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin'}),a0_0x60e11a('span',{'children':'Processing\x20enrollment...'})]})})});if(_0x412965)return a0_0x60e11a('div',{'ref':_0x46d0c3,'children':a0_0x60e11a(a0_0x50a0c1,{'href':'/my-courses','className':className,'children':a0_0x33ae2b(AuroraButton,{'children':[a0_0x60e11a('span',{'children':'Access\x20Courses'}),a0_0x60e11a(CheckCircle,{'className':'ml-2 w-5 h-5'})]})})});if(!_0x28d592?.['id']){const _0x3d4d3b=()=>{_0x3fa493(!![]);};return a0_0x60e11a('div',{'ref':_0x46d0c3,'children':a0_0x60e11a(SignInButton,{'mode':'modal','children':a0_0x60e11a(AuroraButton,{'className':className,'onClick':_0x3d4d3b,'children':ctaText})})});}return a0_0x60e11a('div',{'ref':_0x46d0c3,'children':a0_0x60e11a(AuroraButton,{'onClick':()=>_0x12570d(_0x26b369),'className':className,'children':ctaText})});}function a0_0x10a5(){const _0x5a90d4=['341820NAAOfs','66314xIDIYW','8050NqbSpk','124JtloSo','24IjnHMd','197755FrOFyc','559755mSRmDY','4284avrtuy','div','19243940WGHmHZ','3668958XLQsUu'];a0_0x10a5=function(){return _0x5a90d4;};return a0_0x10a5();}export default BundleEnrollButton;
