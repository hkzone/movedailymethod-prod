"use client";

'use client';(function(_0x53039d,_0x5575f2){const _0xb6881e=a0_0x1393,_0x1bcc1a=_0x53039d();while(!![]){try{const _0x19e35c=-parseInt(_0xb6881e(0x177))/0x1*(-parseInt(_0xb6881e(0x172))/0x2)+-parseInt(_0xb6881e(0x16d))/0x3+-parseInt(_0xb6881e(0x178))/0x4*(-parseInt(_0xb6881e(0x176))/0x5)+-parseInt(_0xb6881e(0x174))/0x6+-parseInt(_0xb6881e(0x173))/0x7+parseInt(_0xb6881e(0x171))/0x8*(-parseInt(_0xb6881e(0x17a))/0x9)+parseInt(_0xb6881e(0x179))/0xa;if(_0x19e35c===_0x5575f2)break;else _0x1bcc1a['push'](_0x1bcc1a['shift']());}catch(_0x3fccb1){_0x1bcc1a['push'](_0x1bcc1a['shift']());}}}(a0_0xbd78,0xee238));function a0_0x1393(_0x1415c9,_0x24364f){const _0xbd7898=a0_0xbd78();return a0_0x1393=function(_0x1393bb,_0x3cd39f){_0x1393bb=_0x1393bb-0x16d;let _0x3642e6=_0xbd7898[_0x1393bb];return _0x3642e6;},a0_0x1393(_0x1415c9,_0x24364f);}function a0_0xbd78(){const _0x2fd693=['20124300LZlssd','108tICtqi','3649407mGBEXx','type','div','data','1070224jXORuv','2984iKPjDb','1037323jFpWpM','4632294shGGUF','error','5zXUJMR','1079UTiPaF','4380644iCDlFQ'];a0_0xbd78=function(){return _0x2fd693;};return a0_0xbd78();}import{jsx as a0_0x28f654,jsxs as a0_0x529ecb}from'react/jsx-runtime';import{createBundleCheckout}from'@/actions/createBundleCheckout';import{createWayforpayBundleCheckout}from'@/actions/createWayforpayBundleCheckout';import{useUser,SignInButton}from'@clerk/nextjs';import{CheckCircle}from'lucide-react';import a0_0x67a8e1 from'next/link';import{useRouter}from'next/navigation';import{useTransition,useEffect,useState,useRef}from'react';import{AuroraButton}from'./ui/aurora-button';function BundleEnrollButton({bundleId:_0x55b8d0,isEnrolled:_0x34084b,ctaText:ctaText='CLAIM\x20DEAL',className:className=''}){const _0x8c1dfe=a0_0x1393,{user:_0x9f03e5,isLoaded:_0x4b44b4}=useUser(),_0x124a17=useRouter(),[_0x61067c,_0x223b8d]=useTransition(),[_0x6a31b1,_0x8c37d6]=useState(![]),_0x4905f6=useRef(null),_0x5c02b8=useRef(null);useEffect(()=>{_0x4b44b4&&_0x9f03e5&&_0x6a31b1&&(_0x5c02b8['current']&&(clearTimeout(_0x5c02b8['current']),_0x5c02b8['current']=null),_0x8c37d6(![]),setTimeout(()=>{_0x4905f6['current']?.['scrollIntoView']({'behavior':'instant','block':'center'});},0x64),_0x32b7b5(_0x55b8d0));},[_0x4b44b4,_0x9f03e5,_0x6a31b1,_0x55b8d0]),useEffect(()=>{if(!_0x6a31b1)return;const _0x36f2a1=()=>{const _0x9a8c3b=document['body']['style']['overflow'];_0x6a31b1&&!_0x9f03e5&&_0x9a8c3b!=='hidden'&&(_0x5c02b8['current']=setTimeout(()=>{!_0x9f03e5&&_0x6a31b1&&_0x8c37d6(![]);},0x7d0));},_0x2d4179=new MutationObserver(_0x36f2a1);return _0x2d4179['observe'](document['body'],{'attributes':!![],'attributeFilter':['style']}),()=>_0x2d4179['disconnect']();},[_0x6a31b1,_0x9f03e5]);const _0x32b7b5=async _0x415c4d=>{_0x223b8d(async()=>{try{const _0x58be57=_0x9f03e5?.['id'];if(!_0x58be57)return;const _0x4e74ef=process['env']['NEXT_PUBLIC_PAYMENT_PROVIDER'];let _0x2cc910;_0x4e74ef==='wayforpay'?_0x2cc910=await createWayforpayBundleCheckout(_0x415c4d,_0x58be57):_0x2cc910=await createBundleCheckout(_0x415c4d,_0x58be57),_0x541002(_0x2cc910);}catch(_0x2bd63d){console['error']('Error\x20in\x20handleEnroll:',_0x2bd63d),alert('Failed\x20to\x20create\x20checkout\x20session.\x20Please\x20try\x20again.'),_0x8c37d6(![]);}});},_0x541002=_0x5305d9=>{const _0x8f50e8=a0_0x1393;if(!_0x5305d9){alert('Enrollment\x20failed:\x20No\x20result\x20from\x20server.');return;}if(_0x5305d9[_0x8f50e8(0x175)]){alert('Enrollment\x20failed:\x20'+_0x5305d9['error']);return;}if(_0x5305d9[_0x8f50e8(0x16e)]==='url'&&_0x5305d9['data'])_0x124a17['push'](_0x5305d9[_0x8f50e8(0x170)]);else{if(_0x5305d9[_0x8f50e8(0x16e)]==='form'&&_0x5305d9['data']){const _0xbb2fa1=document['createElement']('div');_0xbb2fa1['innerHTML']=_0x5305d9['data'],document['body']['appendChild'](_0xbb2fa1);const _0x3e4f5c=_0xbb2fa1['querySelector']('form');_0x3e4f5c&&_0x3e4f5c['submit']();}else _0x5305d9['type']==='redirect'&&_0x5305d9['data']?_0x124a17['push'](_0x5305d9['data']):alert('Enrollment\x20failed:\x20Unexpected\x20server\x20response.');}};if(_0x6a31b1||_0x61067c)return a0_0x28f654('div',{'ref':_0x4905f6,'children':a0_0x28f654(AuroraButton,{'disabled':!![],'className':className,'children':a0_0x529ecb('div',{'className':'flex items-center gap-2','children':[a0_0x28f654('div',{'className':'w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin'}),a0_0x28f654('span',{'children':'Processing\x20enrollment...'})]})})});if(_0x34084b)return a0_0x28f654('div',{'ref':_0x4905f6,'children':a0_0x28f654(a0_0x67a8e1,{'href':'/my-courses','className':className,'children':a0_0x529ecb(AuroraButton,{'children':[a0_0x28f654('span',{'children':'Access\x20Courses'}),a0_0x28f654(CheckCircle,{'className':'ml-2 w-5 h-5'})]})})});if(!_0x9f03e5?.['id']){const _0x210ebf=()=>{_0x8c37d6(!![]);};return a0_0x28f654('div',{'ref':_0x4905f6,'children':a0_0x28f654(SignInButton,{'mode':'modal','children':a0_0x28f654(AuroraButton,{'className':className,'onClick':_0x210ebf,'children':ctaText})})});}return a0_0x28f654(_0x8c1dfe(0x16f),{'ref':_0x4905f6,'children':a0_0x28f654(AuroraButton,{'onClick':()=>_0x32b7b5(_0x55b8d0),'className':className,'children':ctaText})});}export default BundleEnrollButton;
