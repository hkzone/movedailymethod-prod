"use client";

'use client';(function(_0x32339d,_0x1737b2){const _0x4c0a6b=a0_0x6ab2,_0x4067cb=_0x32339d();while(!![]){try{const _0x34aefe=parseInt(_0x4c0a6b(0xe1))/0x1*(parseInt(_0x4c0a6b(0xdd))/0x2)+-parseInt(_0x4c0a6b(0xe5))/0x3*(parseInt(_0x4c0a6b(0xe0))/0x4)+-parseInt(_0x4c0a6b(0xeb))/0x5*(-parseInt(_0x4c0a6b(0xe3))/0x6)+-parseInt(_0x4c0a6b(0xe7))/0x7*(-parseInt(_0x4c0a6b(0xe4))/0x8)+-parseInt(_0x4c0a6b(0xe8))/0x9*(-parseInt(_0x4c0a6b(0xed))/0xa)+-parseInt(_0x4c0a6b(0xea))/0xb*(parseInt(_0x4c0a6b(0xe2))/0xc)+-parseInt(_0x4c0a6b(0xe9))/0xd;if(_0x34aefe===_0x1737b2)break;else _0x4067cb['push'](_0x4067cb['shift']());}catch(_0x400800){_0x4067cb['push'](_0x4067cb['shift']());}}}(a0_0x6617,0x7e1ad));function a0_0x6617(){const _0x2a4db9=['querySelector','805524zUkkHq','1qhpLmW','12ZvtfWw','856848sIHGGI','2516328ibTXHo','6TTpLhm','data','7QqDRiN','9kEAakU','1117636kNfcGa','8733571SumQam','10ASvPLj','div','7287460ixvqAm','Enrollment\x20failed:\x20Unexpected\x20server\x20response.','body','940634IqNlse','redirect'];a0_0x6617=function(){return _0x2a4db9;};return a0_0x6617();}import{jsx as a0_0x25b808,jsxs as a0_0x23c6c3}from'react/jsx-runtime';import{createBundleCheckout}from'@/actions/createBundleCheckout';import{createWayforpayBundleCheckout}from'@/actions/createWayforpayBundleCheckout';import{useUser,SignInButton}from'@clerk/nextjs';import{CheckCircle}from'lucide-react';function a0_0x6ab2(_0x487ca5,_0x384949){const _0x66177b=a0_0x6617();return a0_0x6ab2=function(_0x6ab263,_0x4d05d4){_0x6ab263=_0x6ab263-0xdd;let _0x14a66d=_0x66177b[_0x6ab263];return _0x14a66d;},a0_0x6ab2(_0x487ca5,_0x384949);}import a0_0x6edae8 from'next/link';import{useRouter}from'next/navigation';import{useTransition,useEffect,useState,useRef}from'react';import{AuroraButton}from'./ui/aurora-button';function BundleEnrollButton({bundleId:_0x257e46,isEnrolled:_0x5e9817,ctaText:ctaText='CLAIM\x20DEAL',className:className=''}){const _0x38e0d1=a0_0x6ab2,{user:_0x3e35a0,isLoaded:_0x4b41d7}=useUser(),_0x157c3b=useRouter(),[_0x56f00b,_0x3031b8]=useTransition(),[_0x209b3e,_0x374d73]=useState(![]),_0x132530=useRef(null),_0x26df75=useRef(null);useEffect(()=>{_0x4b41d7&&_0x3e35a0&&_0x209b3e&&(_0x26df75['current']&&(clearTimeout(_0x26df75['current']),_0x26df75['current']=null),_0x374d73(![]),setTimeout(()=>{_0x132530['current']?.['scrollIntoView']({'behavior':'instant','block':'center'});},0x64),_0x7180c2(_0x257e46));},[_0x4b41d7,_0x3e35a0,_0x209b3e,_0x257e46]),useEffect(()=>{if(!_0x209b3e)return;const _0x5b3992=()=>{const _0x2684c6=a0_0x6ab2,_0x59afde=document[_0x2684c6(0xef)]['style']['overflow'];_0x209b3e&&!_0x3e35a0&&_0x59afde!=='hidden'&&(_0x26df75['current']=setTimeout(()=>{!_0x3e35a0&&_0x209b3e&&_0x374d73(![]);},0x7d0));},_0x251fe8=new MutationObserver(_0x5b3992);return _0x251fe8['observe'](document['body'],{'attributes':!![],'attributeFilter':['style']}),()=>_0x251fe8['disconnect']();},[_0x209b3e,_0x3e35a0]);const _0x7180c2=async _0x39ba4e=>{_0x3031b8(async()=>{try{const _0x25e019=_0x3e35a0?.['id'];if(!_0x25e019)return;const _0x27998b=process['env']['NEXT_PUBLIC_PAYMENT_PROVIDER'];let _0x396578;_0x27998b==='wayforpay'?_0x396578=await createWayforpayBundleCheckout(_0x39ba4e,_0x25e019):_0x396578=await createBundleCheckout(_0x39ba4e,_0x25e019),_0x187c12(_0x396578);}catch(_0x19df80){console['error']('Error\x20in\x20handleEnroll:',_0x19df80),alert('Failed\x20to\x20create\x20checkout\x20session.\x20Please\x20try\x20again.'),_0x374d73(![]);}});},_0x187c12=_0x378bc8=>{const _0x3a6cfc=a0_0x6ab2;if(!_0x378bc8){alert('Enrollment\x20failed:\x20No\x20result\x20from\x20server.');return;}if(_0x378bc8['error']){alert('Enrollment\x20failed:\x20'+_0x378bc8['error']);return;}if(_0x378bc8['type']==='url'&&_0x378bc8['data'])_0x157c3b['push'](_0x378bc8['data']);else{if(_0x378bc8['type']==='form'&&_0x378bc8[_0x3a6cfc(0xe6)]){const _0x325245=document['createElement']('div');_0x325245['innerHTML']=_0x378bc8[_0x3a6cfc(0xe6)],document[_0x3a6cfc(0xef)]['appendChild'](_0x325245);const _0x282f59=_0x325245[_0x3a6cfc(0xdf)]('form');_0x282f59&&_0x282f59['submit']();}else _0x378bc8['type']===_0x3a6cfc(0xde)&&_0x378bc8['data']?_0x157c3b['push'](_0x378bc8[_0x3a6cfc(0xe6)]):alert(_0x3a6cfc(0xee));}};if(_0x209b3e||_0x56f00b)return a0_0x25b808('div',{'ref':_0x132530,'children':a0_0x25b808(AuroraButton,{'disabled':!![],'className':className,'children':a0_0x23c6c3('div',{'className':'flex items-center gap-2','children':[a0_0x25b808('div',{'className':'w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin'}),a0_0x25b808('span',{'children':'Processing\x20enrollment...'})]})})});if(_0x5e9817)return a0_0x25b808('div',{'ref':_0x132530,'children':a0_0x25b808(a0_0x6edae8,{'href':'/my-courses','className':className,'children':a0_0x23c6c3(AuroraButton,{'children':[a0_0x25b808('span',{'children':'Access\x20Courses'}),a0_0x25b808(CheckCircle,{'className':'ml-2 w-5 h-5'})]})})});if(!_0x3e35a0?.['id']){const _0x181532=()=>{_0x374d73(!![]);};return a0_0x25b808(_0x38e0d1(0xec),{'ref':_0x132530,'children':a0_0x25b808(SignInButton,{'mode':'modal','children':a0_0x25b808(AuroraButton,{'className':className,'onClick':_0x181532,'children':ctaText})})});}return a0_0x25b808('div',{'ref':_0x132530,'children':a0_0x25b808(AuroraButton,{'onClick':()=>_0x7180c2(_0x257e46),'className':className,'children':ctaText})});}export default BundleEnrollButton;
